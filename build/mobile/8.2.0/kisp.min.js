!function(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p,g,v,m,y,w,b,$,x,S,k,C,T){var I,j,P,M=function(e){var t=new w,n={seperator:"/",cross:!1,repeated:!1,Emitter:null};function r(e){var r=x.assign({},n,e),i=r.Emitter,a=i?new i(this):null,o={id$module:{},seperator:r.seperator,cross:r.cross,repeated:r.repeated,emitter:a,Emitter:i,this:this,require:function(e){return o.this.require(e,!1)},fire:function(){a&&a.fire(...arguments)},getParent:function(e){var t=o.seperator,n=e.split(t);if(1==n.length)return null;var r=n.slice(0,-1).join(t);return o.id$module[r]||null}};t.set(this,o),this.on("require",function(e,t,n){t.fire("require",[n]);var r=t.parent;r&&r.fire("require",t.name,[n])})}return r.prototype={constructor:r,has:function(e){return t.get(this).id$module.hasOwnProperty(e)},define:function(e,n){if("string"!=typeof e)throw new v(`参数 id 的类型必须为 string，当前为: ${typeof e}`);var r=t.get(this),i=r.id$module;if(!r.repeated&&i[e])throw new v(`配置设定了不允许定义重复的模块: 已存在名为 ${e} 的模块`);var a=r.Emitter,o=a?new a:null,s=e.split(r.seperator).slice(-1)[0];i[e]={id:e,name:s,factory:n,emitter:o,parent:null,required:!1,count:0,exports:null,mod:null,fire:function(){o&&o.fire(...arguments)}}},require:function(n,r){if("string"!=typeof n)throw new v(`参数 id 的类型必须为 string，当前为: ${typeof n}`);var i=t.get(this),a=i.seperator;if(r===T&&(r=i.cross),!r&&n.includes(a))throw new v(`参数指定了或配置设定了不允许跨级加载模块: ${n}`);if(this.has(n)){var o=i.id$module[n];if(o.count++,o.required)return o.exports;o.required=!0;var s=o.factory,u=o.parent=i.getParent(n);if("function"!=typeof s)return o.exports=s,i.fire("require",[n,o,s]),s;var l={},c=o.mod=new e(n,{seperator:a,mm:this,emitter:o.emitter,exports:l,parent:u?u.mod:null});return(l=s(i.require,c,l))===T&&(l=c.exports),o.exports=l,c.exports=l,i.fire("require",[n,o,l]),l}},on:function(...e){var n=t.get(this).emitter;n&&n.on(...e)},destroy:function(){var e=t.get(this).emitter;e&&e.destroy(),t.delete(this)}},r}(function(){var e=new w;function t(t,n){var r=n.seperator,i=t.split(r),a=i.slice(-1)[0],o=n.parent;o&&(o=x.create(o,{require:{value:function(e){throw new v(`禁止通过父模块来加载同级模块：模块 ${t} 尝试加载同级模块 ${e}。`)}}}));var s={id:t,seperator:r,emitter:n.emitter,mm:n.mm,this:this};e.set(this,s),x.assign(this,{id:t,name:a,names:i,seperator:r,exports:n.exports,parent:o})}return t.prototype={constructor:t,id:"",name:"",seperator:"",exports:null,parent:null,on:function(...t){var n=e.get(this).emitter;n&&n.on(...t)},require:function(t){var n=e.get(this),r=n.seperator,i=n.id+r+t;if(t.includes(r))throw new v(`模块 ${n.id} 不允许跨级加载模块: ${i}`);return n.mm.require(i,!0)},bind:function(t,n){var r="object"==typeof t?t:{[t]:n},i=e.get(this);x.keys(r).forEach(function(e){var t=r[e],n="function"==typeof t?t:function(e){e.on(t)};i.this.on("require",e,n)})},render:function(e,...t){var n=this.require(e);if(!n)throw new v(`模块 ${meta.id} 不存在名为 ${e} 的直接子模块`);return n.render(...t),n}},t}()),E=function(e){var t=new e({cross:!0}),n={};return{has:t.has.bind(t),define:t.define.bind(t),require:t.require.bind(t),bind:function(e,n,r){return function(...i){var a=t.require(e),o=a[n];if("function"!=typeof o)throw new v(`要绑定的模块 ${e} 中不存在名为 ${n} 的方法或函数。`);return r=!0===r?a:r||null,o.call(r,...i)}},expose:function(e,t){if(h.isArray(e))e.forEach(function(e){n[e]=!0});else if("object"!=typeof e)2!=arguments.length?n[e]:n[e]=!!t;else{var r=e;x.keys(r).forEach(function(e){n[e]=!!r[e]})}}}}(M),q=E.define;q("Array",function(e,t,n){return n={each:function(e,t,n){for(var r=arguments.callee,i=e.length,a=0;a<i;a++){var o=e[a];if(n&&o instanceof h)r(o,t,!0);else if(!1===t(o,a))break}return e},map:function(e,t,n){for(var r,i=arguments.callee,a=e.length,o=[],s=0;s<a;s++){var u=e[s];if(n&&u instanceof h)r=i(u,t,!0);else{if(null===(r=t(u,s)))continue;if(r===T)break}o.push(r)}return o},keep:function(e,t,n){for(var r=arguments.callee,i=[],a=0,o=e.length;a<o;a++){var s=e[a],u=n&&s instanceof h?r(s,t,!0):t(s,a);i.push(u)}return i},grep:function(e,t,n){for(var r=arguments.callee,i=[],a=0,o=e.length;a<o;a++){var s=e[a];if(n&&s instanceof h)s=r(s,t,!0),i.push(s);else!0===t(s,a)&&i.push(s)}return i},slide:function(e,t,n){if(t>=e.length)return[e];n=n||1;for(var r=[],i=0,a=e.length;i<a;i+=n){var o=i+t;if(r.push(e.slice(i,o)),o>=a)break}return r},group:function(e,t,r){var i=n.slide(e,t,t);return!0===r&&(i[i.length-1]=e.slice(-t)),i},sum:function(e,t,r){var i=0;if("function"==typeof t){var a=t;return n.each(e,function(e,t){var n=a(e,t);if("number"!=typeof n)throw new v("第 "+t+" 个元素的返回值不是数字");i+=n}),i}for(var o=!(r===T),s=0,u=e.length;s<u;s++){var l=o?e[s][r]:e[s];if(isNaN(l)){if(!0===t)continue;throw new v("第 "+s+" 个元素的值为 NaN")}i+=$(l)}return i},pad:function(e,t,n,r){if(e==t)return[];"function"==typeof n?(r=n,n=1):n=b.abs(n||1);var i=[],a=0;if(e<t)for(var o=e;o<t;o+=n){var s=r?r(o,a):o;i.push(s),a++}else for(o=e;o>t;o-=n){s=r?r(o,a):o;i.push(s),a++}return i}}}),q("Date",function(e,t,n){var r=0;function i(e){new g;var t=e.indexOf(".")>0?".":e.indexOf("-")>0?"-":e.indexOf("/")>0?"/":e.indexOf("_")>0?"_":null;if(!t)return null;var n=e.split(t);return{yyyy:n[0],MM:n[1]||0,dd:n[2]||1}}function a(e){var t=e.indexOf(":")>0?":":null;if(!t)return null;var n=e.split(t);return{HH:n[0]||0,mm:n[1]||0,ss:n[2]||0}}return n={parse:function(e){var t=new g(e);if(!isNaN(t))return t;if("string"!=typeof e)return null;var n=e.split(" "),r=n[0];if(!r)return null;var o=(t=r.indexOf(":")>0?null:r)?n[1]||null:t;if(!t&&!o)return null;if(t&&o){var s=i(t),u=a(o);return new g(s.yyyy,s.MM-1,s.dd,u.HH,u.mm,u.ss)}if(t){s=i(t);return new g(s.yyyy,s.MM-1,s.dd)}if(o){var l=new g;u=a(o);return new g(l.getFullYear(),l.getMonth(),l.getDate(),u.HH,u.mm,u.ss)}},format:function(t,r){1==arguments.length?(r=t,t=new g):t=n.parse(t);for(var i=e("String"),a=t.getFullYear(),o=t.getMonth()+1,s=t.getDate(),u=t.getHours(),l=t.getMinutes(),c=t.getSeconds(),f=function(e,t){return i.padLeft(e,t,"0")},d=u<=12,h=[["yyyy",f(a,4)],["yy",k(a).slice(2)],["MM",f(o,2)],["M",o],["dddd","星期"+"日一二三四五六".charAt(t.getDay())],["dd",f(s,2)],["d",s],["HH",f(u,2)],["H",u],["hh",f(d?u:u-12,2)],["h",d?u:u-12],["mm",f(l,2)],["m",l],["ss",f(c,2)],["s",c],["tt",d?"AM":"PM"],["t",d?"A":"P"],["TT",d?"上午":"下午"],["T",d?"上":"下"]],p=r,v=i.replaceAll,m=0,y=h.length;m<y;m++){var w=h[m];p=v(p,w[0],w[1])}return p},add:function(e,t,r){var i=(e=n.parse(e)).getMilliseconds(),a=new g(e);return a.setMilliseconds(i+t),r&&(a=n.format(a,r)),a},addSeconds:function(e,t,r){return n.add(e,1e3*t,r)},addMinutes:function(e,t,r){return n.addSeconds(e,60*t,r)},addHours:function(e,t,r){return n.addMinutes(e,60*t,r)},addDays:function(e,t,r){return n.addHours(e,24*t,r)},addWeeks:function(e,t,r){return n.addDays(e,7*t,r)},addMonths:function(e,t,r){e=n.parse(e);var i=new g(e),a=e.getMonth();return i.setMonth(a+t),r&&(i=n.format(i,r)),i},addYears:function(e,t,r){return n.addMonths(e,12*t,r)},set:function(e){var t=n.parse(e);if(!t)throw new v("无法识别的日期时间格式: "+e);r=t-g.now()},get:function(e){var t=new g;return 0!=r&&(t=n.add(t,r)),e&&(t=n.format(t,e)),t},stringify:function(e){return e=e||new g,n.format(e,"yyyy-MM-dd HH:mm:ss")}}}),q("String",function(e,t,n){return n={random:function(e){if(e===T&&(e=12),"number"==typeof e){var t=e+1;t<0&&(t=0),(e=[]).length=t,e=e.join("x")}return e.replace(/x/g,function(e){return(16*b.random()|0).toString(16)}).toUpperCase()},format:function(e,t){var r=e,i=n.replaceAll;if("object"==typeof t)for(var a in t){var o=t[a];h.isArray(o)&&(o=o.join("")),r=i(r,"{"+a+"}",o)}else for(var s=[].slice.call(arguments,1),u=0,l=s.length;u<l;u++){o=s[u];h.isArray(o)&&(o=o.join("")),r=i(r,"{"+u+"}",o)}return r},replaceAll:function(e,t,n){return e.split(t).join(n)},replaceBetween:function(e,t,n,r){if("object"==typeof t){var i=t;t=i.begin,n=i.end,r=i.value}return e.indexOf(t)<0||e.indexOf(n)<0?e:e=e.split(t).map(function(e){var t=e.split(n);return 1==t.length?t[0]:r+t.slice(1).join(n)}).join("")},padLeft:function(e,t,n){var r=(e=k(e)).length;if(t<=r)return e.substr(-t);n=n||" ";var i=[];return i.length=t-r+1,i.join(n)+e},padRight:function(e,t,n){var r=(e=k(e)).length;if(r>=t)return e.substring(0,t);n=n||" ";var i=[];return i.length=t-r+1,e+i.join(n)},between:function(e,t,n){var r=e.indexOf(t);if(r<0)return"";r+=t.length;var i=e.indexOf(n,r);return i<0?"":e.substr(r,i-r)},toCamelCase:function(e){return e.replace(/^-ms-/,"ms-").replace(/-([a-z]|[0-9])/gi,function(e,t){return t.toString().toUpperCase()})},toHyphenate:function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.charAt(0).toLowerCase()})},toUtf8:function(t){var n=e("Array"),r=[];return n.each(t.split(""),function(e,t){var n=e.charCodeAt(0);n<128?r.push(n):n<2048?(r.push((1984&n)>>6|192),r.push(63&n|128)):(r.push((61440&n)>>12|224),r.push((4032&n)>>6|128),r.push(63&n|128))}),"%"+n.keep(r,function(e,t){return e.toString(16)}).join("%")},toValue:function(e){if("string"!=typeof e)return e;var t={true:!0,false:!1,null:null,undefined:T,NaN:NaN};return e in t?t[e]:e},split:function(t,n){for(var r=e("Array"),i=k(t).split(n[0]),a=1,o=n.length;a<o;a++)i=s(i,n[a],a);return i;function s(e,t,n){return n--,r.map(e,function(e,r){return 0==n?k(e).split(t):s(e,t,n)})}},getByteLength:function(e){return e?e.toString().replace(/[\u0100-\uffff]/g,"  ").length:0}}}),q("Emitter",function(e,t,n){var r=e("Object"),i=e("Tree"),a=new w;function o(e){var t={context:e,tree:new i};a.set(this,t)}return o.prototype={constructor:o,on:function(e,t){if(h.isArray(e))t?e.map(function(e){this.on(e,t)},this):this.on(...e);else{var n=a.get(this).tree,i=h.from(arguments);if((u=i.findIndex(function(e,t){return"object"==typeof e}))>=0){var o=i[u],s=i.slice(0,u);r.flat(o).forEach(function(e,t){var r=s.concat(e.keys),i=n.get(r)||{list:[],count:0};i.list.push(e.value),n.set(r,i)})}else{var u;if((u=i.findIndex(function(e,t){return"function"==typeof e}))<0)throw new v("参数中必须指定一个回调函数");t=i[u],s=(s=i.slice(0,u)).filter(function(e){return!!e});var l=n.get(s)||{list:[],count:0,enabled:!0,spreaded:!0};l.list.push(t),n.set(s,l)}}},off:function(e,t){var n=a.get(this).tree,i=h.from(arguments);if(0!=i.length)if((u=i.findIndex(function(e,t){return"object"==typeof e}))>=0){var o=i[u],s=i.slice(0,u);(l=r.flat(o)).forEach(function(e,t){var r=s.concat(e.keys),i=n.get(r);if(i){var a=i.list;if(a&&a.length){var o=e.value;i.list=a.filter(function(e){return e!==o})}}})}else{var u;(u=i.findIndex(function(e,t){return"function"==typeof e}))<0&&(u=i.length),t=i[u];s=i.slice(0,u);var l,c=n.get(s);if(c)(l=c.list)&&l.length&&(t?c.list=l.filter(function(e,n){return e!==t}):l.length=0)}else n.clear()},fire:function(e,t){var n=a.get(this),r=[...arguments],i=r.findIndex(function(e,t){return h.isArray(e)});i<0&&(i=r.length);var o=r.slice(0,i),s=n.tree.get(o);return s?(t=r[i]||[],s.count++,s.list.map(function(e,r){return e.apply(n.context,t)})):[]},set:function(e,t){var n=a.get(this);switch(e){case"context":n[e]=t;break;default:throw new v("不支持设置属性: "+e)}},destroy:function(){a.get(this).tree.destroy(),a.delete(this)}},o}),q("Object",function(e,t,n){return n={extend:x.assign,extendDeeply:function(e,t,r){var i=n.isPlain;function a(e,t){for(var n in e=e||{},t){var r=t[n],o=e[n];i(r)&&(r=a(o=i(o)?a({},o):{},r)),e[n]=r}return e}t&&"object"==typeof t&&(e=a(e,t)),r&&"object"==typeof r&&(e=a(e,r));var o=arguments.length;if(3>=o)return e;for(var s=3;s<o;s++){e=a(e,arguments[s])}return e},isEmpty:function(e){for(var t in e)return!1;return!0},isPlain:function(e){if(!e||"object"!=typeof e)return!1;var t,n=x.prototype.hasOwnProperty,r=e.constructor;try{if(r&&!n.call(e,"constructor")&&!n.call(r.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(t in e);return t===T||n.call(e,t)},flat:function(e){var t=n.isPlain,r=[];if(!e||!t(e))return r;var i=[];return function e(n,a){for(var o in n){var s=n[o];(i=i.slice(0,a)).push(o),t(s)?e(s,a+1):r.push({keys:i,value:s})}}(e,0),r},each:function(e,t,r){for(var i in e){var a=e[i];if(!1===t(i,a))break;!0===r&&a&&"object"==typeof a&&n.each(a,t,!0)}},map:function(e,t,r){var i={};return n.each(e,function(e,a){r&&n.isPlain(a)?i[e]=n.map(a,t,r):i[e]=t(e,a)}),i},make:function(e,t,n){if(h.isArray(e)&&(n=t,t=e,e={}),!e||"object"!=typeof e)throw new v("参数 obj 必须为一个非空的对象，以作为容器对象。");var r=e,i=t.length-1;return t.map(function(e,t){var a=r[e];t<i?r=r[e]="object"==typeof a&&a||{}:r[e]=n}),e},filter:function(t,r){e("Array");var i={};if(h.isArray(r))r.forEach(function(e,n){e in t&&(i[e]=t[e])});else if(n.isPlain(r))n.each(r,function(e,n){e in t&&(i[e]=t[e])});else{if("string"!=typeof r)throw new v("无法识别参数 samples 的类型");var a=r;a in t&&(i[a]=t[a])}return i},remove:function(e,t){var n=x.assign({},e);if("string"==typeof t)delete n[t];else if(h.isArray(t))for(var r=0,i=t.length;r<i;r++)delete n[t[r]];else for(var a in t)delete n[a];return n}}}),q("Tree",function(e,t,n){var r=new w;function i(){r.set(this,{key$node:{},count:0})}function a(e,t){for(var n=t.length-1,r=0;r<=n;r++){var i=e[t[r]];if(!i||r==n)return i||null;e=i.key$node}}return i.prototype={constructor:i,set:function(e,t){if(!h.isArray(e)){var n=h.from(arguments);e=n.slice(0,-1),t=n.slice(-1)[0]}if(!(e=e.filter(function(e){return!!k(e)})).length)throw new v("过滤后的节点 key 为空数组。");var i=r.get(this),a=i.key$node,o=e.length-1,s=null;e.forEach(function(e,n){(s=a[e])||(i.count++,s=a[e]={key$node:{},parent:a,key:e}),n<o?a=s.key$node:s.value=t})},get:function(e){if(h.isArray(e)||(e=h.from(arguments)),!(e=e.filter(function(e){return!!k(e)})).length)throw new v("过滤后的节点 key 为空数组。");var t=a(r.get(this).key$node,e);return t?t.value:T},clear:function(){var e=r.get(this);e.key$node={},e.count=0},remove:function(t){if(h.isArray(t)||(t=[...arguments]),!(t=t.filter(function(e){return!!k(e)})).length)throw new v("过滤后的节点 key 为空数组。");var n=r.get(this),i=a(n.key$node,t);if(i){var o=e("Object"),s=i.key$node;!s||o.isEmpty(s)?(n.count--,delete i.parent[i.key]):delete i.value}},destroy:function(){r.delete(this)}},i}),q("Escape",function(e,t,n){return n={html:function(e){var t=k(e);return t=(t=(t=(t=(t=t.replace(/[&'"<>\/\\\-\x00-\x09\x0b-\x0c\x1f\x80-\xff]/g,function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/ /g,"&nbsp;")).replace(/\r\n/g,"<br />")).replace(/\n/g,"<br />")).replace(/\r/g,"<br />")},attribute:function(e){return k(e).replace(/[&'"<>\/\\\-\x00-\x1f\x80-\xff]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},script:function(e){var t=k(e);return t=(t=(t=(t=(t=t.replace(/[\\"']/g,function(e){return"\\"+e})).replace(/%/g,"\\x25")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\x01/g,"\\x01")},query:function(e){var t=k(e);return escape(t).replace(/\+/g,"%2B")},hrefScript:function(e){var t=n.escapeScript(e);return t=t.replace(/%/g,"%25"),t=n.escapeElementAttribute(t)},regexp:function(e){return k(e).replace(/[\\\^\$\*\+\?\{\}\.\(\)\[\]]/g,function(e,t){return"\\"+e})}}}),q("Fn",function(e,t,n){return{noop:function(...e){return e[0]},delay:function(t,n,r){if(n){if(!1!==t&&null!=t){var i=e("Math"),a="number"==typeof t?t:i.randomInt(t.min,t.max);return f(function(){n.apply(null,r)},a)}n.apply(null,r)}}}}),q("Math",function(e,t,n){return n={randomInt:function(e,t){var n=arguments.length;if(0==n)return $(k(b.random()).replace(".","").replace(/^0*/g,""));1==n&&(t=e,e=0);var r=t-e+1;return b.floor(b.random()*r+e)},slide:function(e,t,n){return(e+=n=n||1)>=0?e%t:(t-b.abs(e)%t)%t},next:function(e,t){return n.slide(e,t,1)},previous:function(e,t,r){return n.slide(e,t,-1)},parsePercent:function(e){if("string"!=typeof e)return e;var t=e.trim();return"%"!=t.slide(-1)?e:parseFloat(t)/100}}}),q("Hash",function(e,t,n){var r=e("Object");return n={get:function(t,n,r){"object"==typeof t&&(t="href"in t?t.href:t.location.href);var i=t.indexOf("#");if(!(i<0)){var a=t.length,o=t.slice(i+1,a);if(o=unescape(o),""===n)return o;var s=e("Query").parse(o);if(n===T)return s;if(!r||n in s)return s[n];for(var u in n=n.toString().toLowerCase(),s)if(u.toLowerCase()==n)return s[u]}},set:function(t,n,i){var a=null;"object"==typeof t&&(t=(a="href"in t?t:t.location).href);var o=typeof n,s=/^(string|number|boolean)$/.test(o),u="";if(2==arguments.length&&s)u=k(n);else{var l=e("Query"),c="object"==o?n:r.make(n,i);u=l.stringify(c)}u=escape(u);var f=t.lastIndexOf("#");return f>-1&&(t=t.slice(0,f)),t=t+"#"+u,a&&(a.hash=u),t},has:function(e,t,i){"object"==typeof e&&(e="href"in e?e.href:e.location.href);var a=n.get(e);if(!a)return!1;if(!t)return!r.isEmpty(a);if(t in a)return!0;if(i)for(var o in t=t.toString().toLowerCase(),a)if(o.toLowerCase()==t)return!0;return!1},onchange:function(e,t,r){"function"==typeof t&&(r=t,t=!1);var i=n.get(e,"");t&&r.call(e,i,null,t),C(e).on("hashchange",function(){var t=i;i=n.get(e,""),r&&r(i,t,!1)})}}}),q("Query",function(e,t,n){var r=e("Object");return n={parse:function(t,r,i){if(!t||"string"!=typeof t)return{};var a=e("String"),o=i?unescape:decodeURIComponent,s=!r,u=a.toValue,l={};return t.split("&").map(function(e){var t=e.split("="),r=o(t[0]),i=t[1];if(t.length>1&&(i=o(i),i=s&&i.indexOf("=")>0?n.parse(i):u(i)),r in l){var a=l[r];a instanceof h?a.push(i):l[r]=[a,i]}else l[r]=i}),l},stringify:function(e,t){if(null==e)return k(e);switch(typeof e){case"string":case"number":case"boolean":return e}if(e instanceof k||e instanceof $||e instanceof p||e instanceof g)return e.valueOf();if(h.isArray(e))return"["+e.join(", ")+"]";var i=t?escape:encodeURIComponent,a=[];return r.each(e,function(e,t){e=i(e),t!==T?(t=n.stringify(t),t=i(t),a.push(e+"="+t)):a.push(e)}),a.join("&")},get:function(e,t,r){"object"==typeof e&&(e="href"in e?e.href:e.location.href);var i=e.indexOf("?");if(!(i<0)){var a=e.indexOf("#");a<0&&(a=e.length);var o=e.slice(i+1,a);if(""===t)return decodeURIComponent(o);var s=n.parse(o);if(t===T)return s;if(!r||t in s)return s[t];for(var u in t=t.toString().toLowerCase(),s)if(u.toLowerCase()==t)return s[u]}},add:function(e,t,r){var i=n.get(e)||{};"object"==typeof t?x.assign(i,t):i[t]=r;var a={};for(var t in i){null!==(r=i[t])&&(a[t]=r)}return n.set(e,a)},random:function(t,r){var i=e("String").random(r);return n.add(t,i,T)},set:function(e,t,i){var a=null;"object"==typeof e&&(e=(a="href"in e?e:e.location).href);var o=typeof t,s=/^(string|number|boolean)$/.test(o),u="";if(2==arguments.length&&s)u=encodeURIComponent(t);else{var l="object"==o?t:r.make(t,i);u=n.stringify(l)}var c,f=e.indexOf("?")>-1,d=e.indexOf("#")>-1;return f&&d?(c=e.split(/\?|#/g))[0]+"?"+u+"#"+c[2]:f?(c=e.split("?"))[0]+"?"+u:d?(c=e.split("#"))[0]+"?"+u+"#"+c[1]:(e=e+"?"+u,a&&(a.href=e),e)},has:function(e,t,i){"object"==typeof e&&(e="href"in e?e.href:e.location.href);var a=n.get(e);if(!a)return!1;if(!t)return!r.isEmpty(a);if(t in a)return!0;if(i)for(var o in t=t.toString().toLowerCase(),a)if(o.toLowerCase()==t)return!0;return!1},escape:function(e){var t=k(e);return escape(t).replace(/\+/g,"%2B")}}}),q("JSON",function(e,t,n){var i=r.JSON;return{parse:function(e){try{return i.parse(e)}catch(t){l.warn("使用原生的 JSON.parse() 方法无法解析:",e)}try{var t=["return (function () { ","   var obj = "+e+";","   return obj;","})();"].join("\r\n");return new m(t)()}catch(t){l.warn("使用 new Function() 方法无法解析:",e)}return null},stringify:function(){return i.stringify(...arguments)}}}),q("Script",function(e,t,n){e("String");var i=e("Object"),a={url:"",id:"",charset:"utf-8",document:r.document,onload:null};function o(e,t,n,r){var i;if("object"==typeof e){var a=e;i=a.id,e=a.url,t=a.charset,n=a.document,r=a.onload}var o=n.createElement("script");r&&(o.readyState?o.onreadystatechange=function(){var e=o.readyState;"loaded"!=e&&"complete"!=e||(o.onreadystatechange=null,r())}:o.onload=r),o.src=e,t&&(o.charset=t),i&&(o.id=i),n.head.appendChild(o)}return{load:function(e){var t=x.assign({},a);if(i.isPlain(e))x.assign(t,e);else{switch(t.url=e,typeof arguments[1]){case"string":t.charset=arguments[1];break;case"object":t.document=arguments[1];break;case"function":t.onload=arguments[1]}switch(typeof arguments[2]){case"object":t.document=arguments[2];break;case"function":t.onload=arguments[2]}arguments[3]&&(t.onload=arguments[3])}var n=t.url;if("string"==typeof n)o(t);else{if(!(n instanceof h))throw new v("参数 params.url 必须为 string 或 string 的数组");!function(e,t,n,r){if(0!=e.length){var i=0;!function(){var a=arguments.callee;o(e[i],t,n,function(){++i<e.length?a():r&&r()})}()}else r&&r()}(n,t.charset,t.document,t.onload)}}}}),q("StyleSheet",function(e,t,n){var i={url:"",id:"",charset:"utf-8",document:r.document,onload:null};function a(e,t,n,r){var i;if("object"==typeof e){var a=e;i=a.id,e=a.url,t=a.charset,n=a.document,r=a.onload}var o=n.createElement("link");r&&(o.readyState?o.onreadystatechange=function(){var e=o.readyState;"loaded"!=e&&"complete"!=e||(o.onreadystatechange=null,r())}:o.onload=r),o.href=e,o.rel="stylesheet",t&&(o.charset=t),i&&(o.id=i),n.head.appendChild(o)}return{load:function(t){var n=e("Object"),r=x.assign({},i);if(n.isPlain(t))x.assign(r,t);else{switch(r.url=t,typeof arguments[1]){case"string":r.charset=arguments[1];break;case"object":r.document=arguments[1];break;case"function":r.onload=arguments[1]}switch(typeof arguments[2]){case"object":r.document=arguments[2];break;case"function":r.onload=arguments[2]}arguments[3]&&(r.onload=arguments[3])}var o=r.url;if("string"==typeof o)a(r);else{if(!(o instanceof h))throw new v("参数 params.url 必须为 string 或 string 的数组");!function(e,t,n,r){if(0!=e.length){var i=0;!function(){var o=arguments.callee;a(e[i],t,n,function(){++i<e.length?o():r&&r()})}()}else r&&r()}(o,r.charset,r.document,r.onload)}}}}),q("Tasks",function(e,t,n){var r=e("Emitter"),i=new w,a={};function o(e){var t={emitter:new r(this),list:e||[]};i.set(this,t)}return o.prototype={constructor:o,parallel:function(e){var t=i.get(this);if((e=e||t.list).length){var n=e.length,r=n,a=new h(n),o=new h(n);e.forEach(function(e,i){!function(i){t.emitter.fire("each",[e,i,function(e){if(a[i]=e,o[i]=!0,!(--r>0)){for(var s=0;s<n;s++)if(!o[s])return;t.emitter.fire("all",[a])}}])}(i)})}else t.emitter.fire("all",[[]])},serial:function(e){var t=i.get(this);if((e=e||t.list).length){var n=e.length,r=new h(n);!function i(a){var o=e[a];t.emitter.fire("each",[o,a,function(e){r[a]=e,++a<n?i(a):t.emitter.fire("all",[r])}])}(0)}else t.emitter.fire("all",[])},on:function(...e){i.get(this).emitter.on(...e)}},x.assign(o,{parallel:function(e,t){if(t){var n=new o(e);n.on(t),n.parallel()}},serial:function(e,t){if(t){var n=new o(e);n.on(t),n.serial()}},todo:function(e,t,n){var r=a[e];r?r.push(t):(r=a[e]=[t],n(function(t){return a[e]=null,"function"==typeof t&&r.forEach(function(e,n){t(e,n)}),r}))}}),o}),q("KISP",function(e,t,n){return{name:"mobile",version:"8.2.0",edition:"min",md5:"A23A7C9576B8D3A3B765E2A40AD4F129",babel:"",modules:["Array","Date","String","Emitter","Object","Tree","Escape","Fn","Math","Hash","Query","JSON","Script","StyleSheet","Tasks","KISP","Defaults","Config","Data","Router","Proxy","Proxy.defaults","Url","Url.defaults","App","App.defaults","App.config","OuterModule","OuterModule.defaults","$","Touch","Navigator","Navigator.defaults","SessionStorage","SessionStorage.defaults","Storage","CircularJSON","LocalStorage","LocalStorage.defaults","ViewSlider","ViewSlider.defaults","TransitionEnd","Mask","Mask.defaults","Mask.config","Style","RandomId","Package","Package.defaults","Loading","Loading.defaults","Session","Session.defaults","View","View.defaults","View.config","Panel","Panel.defaults","Template","HTMLParser","Mapper","Alert","Alert.defaults","Alert.config","Dialog","Dialog.defaults","Dialog.config","Scroller","Scroller.defaults","IScroll","Confirm","Confirm.defaults","Confirm.config","API","API.defaults","Tabs","Tabs.defaults","Tabs.config","Toast","Toast.defaults","MD5"],require:function(t){return e(t)},create:function(t,...n){return new(e(t))(...n)},config:E.bind("Defaults","config"),data:E.bind("Data","data"),route:E.bind("Router","set"),proxy:E.bind("Proxy","response"),launch:E.bind("App","launch"),view:E.bind("View","define"),panel:E.bind("Panel","define"),load:E.bind("Package","load"),alert:E.bind("Alert","show"),confirm:E.bind("Confirm","show")}}),q("Defaults",function(e,t,n){var r=e("Object"),i=new(e("Config")),a={};function o(t){if(!a[t]){var n=e(`${t}.defaults`),o=e(`${t}.config`),s=r.extendDeeply({},n,o);a[t]=!0,i.set(t,s)}}return n={set:function(e,t){var n="object"==typeof e?e:{[e]:t};r.each(n,function(e,t){o(e),i.set(e,t)})},get:function(e){return o(e),i.get(e)},clone:function(e,...t){return o(e),i.clone(...arguments)},config:function(e,t){if(1==arguments.length&&"string"==typeof e)return n.get(e);n.set(...arguments)}}}),q("Config",function(e,t,n){var r=e("Object"),i=new w;function a(){i.set(this,{name$data:{}})}return a.prototype={constructor:a,set:function(e,t){var n=i.get(this).name$data,a="object"==typeof e?e:{[e]:t};r.each(a,function(e,t){if(e in n){var i=n[e];r.isPlain(i)?r.extendDeeply(i,t):n[e]=t}else n[e]=t})},get:function(e){return i.get(this).name$data[e]},clone:function(e,...t){var n=this.get(e);return r.extendDeeply({},n,...t)}},a}),q("Data",function(e,t,n){e("Object");var r=new(e("Config"));return{data:function(e,t){if(1==arguments.length&&"string"==typeof e)return r.get(e);r.set(...arguments)}}}),q("Router",function(e,t,n){var r=e("Object"),i={};return{set:function(e,t){if(i[e])throw new v(`重复定义的路由器: ${e}`);i[e]=t},bind:function(e,t,n){var a=r.map(i,function(r,i){return"function"==typeof i&&(i=i(e,t,n)),i});return t.bind(a),a}}}),q("Proxy",function(e,t,n){var r=e("Defaults"),i=e("Fn"),a=null;function o(e){var n=r.get(t.id).delay,a=[].slice.call(arguments,1);i.delay(n,e,a)}function s(e,t){if(e){var n=t.successCode,r=t.field,i=e[r.code];if(i==n){var a=e[r.data]||{};o(t.success,a,e)}else{var s=e[r.msg]||"";o(t.fail,i,s,e)}}else o(t.error)}return{request:function(n,r){var i=e("Url");if(i.isExt(n,".js"))!function(n,r){var i=t.require("Url").get(n);e("Script").load(i,function(){var e=a;a=null,"function"==typeof e&&(e=e(r.data,r)),s(e,r)})}(n,r);else{if(!i.isExt(n,".json"))throw new v("不支持参数 file 的文件类型: "+n);!function(n,r){var i=t.require("Url").get(n),a=new XMLHttpRequest;a.open("get",i,!0),a.onreadystatechange=function(){4==a.readyState&&(200==a.status?s(e("JSON").parse(a.responseText),r):o(r.error))},a.send(null)}(n,r)}},response:function(e){a=e}}}),q("Proxy.defaults",{base:"",delay:{min:500,max:3e3}}),q("Url",function(e,t,n){e("String");var r={root:"",url:"",dir:""};return n={root:function(){if(r.root)return r.root;var n=e("Defaults").get(t.id).root;return"function"==typeof n&&(n=n()),n.endsWith("/")||(n+="/"),r.root=n,n},dir:function(){if(r.dir)return r.dir;var e=n.get().split("/").slice(0,-1).join("/")+"/";return r.dir=e,e},get:function(){if(r.url)return r.url;var n=e("Defaults").get(t.id).id;if(!n)throw new v("必须给引用了 KISP 框架文件的 <script> 标签分配一个 id。");var a=i.getElementById(n).src.split("?")[0];return r.url=a,a},main:function(e){return e=(e=e.split("#")[0]).split("?")[0]},isFull:function(e){return"string"==typeof e&&(e.startsWith("http://")||e.startsWith("https://"))},isExt:function(e,t){return"string"==typeof e&&"string"==typeof t&&(e=n.main(e)).slice(0-t.length).toLowerCase()==t.toLowerCase()},resolve:function(e){var t=arguments.length;if(0==t)throw new v("resolveUrl requires at least one argument; got none.");var n=i.createElement("base");if(n.href=e,1==t)return n.href;var r=i.head;r.insertBefore(n,r.firstChild);for(var a="",o=i.createElement("a"),s=1;s<t;s++)o.href=arguments[s],a=o.href,n.href=a;return r.removeChild(n),a}}}),q("Url.defaults",{id:"script-KISP",root:`${a.protocol}//${a.host}${a.pathname.split("/").slice(0,-1).join("/")}/`}),q("Proxy/Url",function(e,t,n){var r=e("Defaults"),i=e("Query"),a=e("Url");return{get:function(e){return e=function(e){if(a.isFull(e))return e;var n=r.get(t.parent.id).base;if(a.isFull(n))return n+e;var i=a.root();return"/"!=e.slice(0,1)&&(i+=n),i+e}(e),i.random(e)}}}),q("App",function(e,t,n){e("String");var r=e("Defaults"),i=e("OuterModule"),a=e("Router"),o=t.require("Navigator"),s=r.get(t.id);return n={init:function(t){var n=s.name,u=s.root,l=i.defaults.seperator,c=s.predefines||[];if(!n)throw new v("必须首先给应用分配一个唯一的名称，用于在存储中与其它应用区分开。");if("string"!=typeof u)throw new v("应用的顶级模块名称必须为一个 string。");if(u.includes(l))throw new v("应用的顶级模块名称不能含有父子模块的分隔符: "+l);["SessionStorage","LocalStorage"].forEach(function(e){E.has(e)&&r.set(e,{name:n})}),c.forEach(function(t){i.define(t,function(){return e(t)})}),i.define(u,function(e,n,r){s.navigator&&(r=o.create({container:s.view.container,preload:s.view.preload,slide:s.view.slide,animate:s.view.animate,name:s.navigator,module:n})),s.prebind&&a.bind(e,n,r),t&&t(e,n,r)})},launch:function(t){n.init(t),e("Touch"),i.require(s.root)}}}),q("App.defaults",{root:"",name:"",navigator:"default-navigator",prebind:!0,view:{},predefines:["KISP","$"]}),q("App.config",{view:{preload:!0,container:"body",slide:!0,animate:!0}}),q("OuterModule",function(e,t,n){var r=e("Defaults"),i=e("Emitter"),a=r.clone(t.id,{Emitter:i}),o=new M(a);return{defaults:a,define:o.define.bind(o),require:o.require.bind(o)}}),q("OuterModule.defaults",{seperator:"/",repeated:!1,cross:!1}),q("$",function(e,t,n){return r.jQuery||null}),q("Touch",function(e,t,n){var r=e("Object"),i=e("$");function a(e,t){var n=0,r=0,a=!1;return{touchstart:function(e){var o=e.originalEvent,s=o.changedTouches[0],u=o.target;(a=u.disabled)||(n=s.pageX,r=s.pageY,t&&i(this).addClass(t),function(e){e.type;var t=e.tagName.toLowerCase();return"textarea"==t||"input"==t}(u)||e.preventDefault())},touchend:function(o){if(!a){t&&i(this).removeClass(t);var s=o.originalEvent.changedTouches[0],u=s.pageX-n,l=s.pageY-r,c=b.sqrt(u*u+l*l);n=0,r=0,c>10||e.apply(this,[...arguments])}}}}return i.fn.touch=function(e,t,n){if(r.isPlain(e)){var o=this,s=e;return n=t,r.each(s,function(e,t){var r=a(t,n);i(o).delegate(e,r)}),this}if("function"==typeof e){n=t,t=e,e=null;var u=a(t,n);return i(this).on(u)}u=a(t,n);return i(this).delegate(e,u)},i}),q("App/Navigator",function(e,t,n){e("Tasks");var r=e("Navigator"),i=e("ViewSlider"),a=t.require("Views");return{create:function(e){var t=e.module,n=new r(e.name),o=e.animate,s=e.slide,u=function(){n.back(!1)};return n.on("view",function(t,n,r){a.load(t,e,function(e){r.cache&&e.rendered()?e.show():e.render(...n)})}),e.preload&&n.on("immediate",function(n,r){var o=x.keys(r).map(function(e){return r[e]});o=o.sort(function(e,t){return e.timestamp>t.timestamp?-1:1}),a.load(o,e,function(){s&&o.slice(0,-1).forEach(function(e,n){var r=o[n+1],a=r.args;e=t.require(e.view),r=t.require(r.view),i.slide(e,r,{args:a,back:u})})})}),s&&n.on("to",function(n,r,o){n=t.require(n),a.load(r,e,function(e){i.slide(e,n,{back:u})})}),n.on("forward",function(n,r){n=t.require(n),a.load(r,e,function(e){o?i.forward(n,e):(n.hide(),e.show())})}),n.on("back",function(n,r){n=t.require(n),a.load(r,e,function(e){o?i.back(n,e):(n.hide(),e.show())})}),n}}}),q("Navigator",function(e,t,n){var r=e("String"),i=e("Defaults"),a=e("Emitter"),o=t.require("Back"),s=t.require("Meta"),u=t.require("Hash"),l=t.require("Infos"),f=t.require("Router"),d=t.require("Storage"),h=new w;function p(e,n){n="object"==typeof e?e:x.assign({id:e},n),n=i.clone(t.id,n);var r=new a(this),o=f.create(),u=d.create(n),l=s.create(n,{emitter:r,router:o,storage:u,this:this});h.set(this,l),x.assign(this,{id:l.id,_meta:l}),n.simulate&&this.route(p.simulate)}return p.prototype={constructor:p,id:"",render:function(){var e=h.get(this);this.enable(!0),e.rendered||u.init(e)},route:function(e){var t=h.get(this).router,n=e.view$hash,r=e.hash$view,i=e.toHash,a=e.toView;null===r?t.hash$view={}:x.assign(t.hash$view,r),null===n?t.view$hash={}:x.assign(t.view$hash,n),"function"==typeof i&&(t.view2hash=i),"function"==typeof a&&(t.hash2view=a)},to:function(e,...t){if("string"!=typeof e)throw new v("参数 name 必须为 string 类型。");var n=h.get(this),r=n.emitter,i=n.hash$info[n.hash],a=l.set(n,e,t);if(!n.enabled)return a;a.hash!=n.hash&&(n.fireEvent=!1,u.set(a.hash));var o=!1;return"cache"in a&&(o=a.cache,delete a.cache),i&&r.fire("to",[i.view,e,{cache:o,current:i,target:a}]),r.fire("view",[e,t,{cache:o,current:i,target:a}]),i&&r.fire("forward",[i.view,e]),a},back:function(e){switch(typeof e){case"boolean":e={fireEvent:e};break;case"number":case"string":e={target:e};break;default:e=e||{}}var t=h.get(this),n=o.getOffset(t,e.target),r=e.fireEvent,i=e.cache,a=this.get(n);return t.fireEvent=r===T||!!r,a&&"boolean"==typeof i&&(a.cache=i),c.go(n),a},get:function(e){var t=h.get(this);return l.get(t,e)},clear:function(){var e=h.get(this);e.storage&&e.storage.clear(),e.fireEvent=!1,e.hash$info={},u.set("")},reserve:function(e){var t=h.get(this),n=t.router.toHash(e),r=t.hash$info[n];t.hash$info={[n]:r},t.storage&&t.storage.set("hash$info",t.hash$info)},enable:function(e){h.get(this).enabled=!!e},on:function(...e){h.get(this).emitter.on(...e)}},x.assign(p,{simulate:{toHash:function(e){return e?e=`/${e=(e=r.toHyphenate(e)).slice(1)}.html`:e},toView:function(e){return/^\/.+\.html$/.test(e)?(e=e.slice(1,-5),e=(e=r.toCamelCase(e))[0].toUpperCase()+e.slice(1)):e}}}),p}),q("Navigator.defaults",{id:"",enabled:!0,storage:"session",repeated:!1,simulate:!1}),q("Navigator/Back",function(e,t,n){e("$"),e("String");return{getOffset:function(e,t){if(!t)return-1;var n=typeof t;if("number"==n){if(t<0)throw new v("要回退的步数(参数 target) 如果指定为数字时，只能是正数。");return 0-(t||1)}if("string"!=n)throw new v("要回退的目标视图(参数 target) 只能是 number 或 string 类型。");var r=e.hash$info[e.hash];if(!r)throw new v("当前视图为空，无法回退。");var i=e.this.get(),a=r.view,o=-1,s=-1;if(i.forEach(function(e,n){var r=e.view;r==t&&(o=n),r==a&&(s=n)}),o<0)throw new v(`历史记录中不存在名为 ${t} 的目标视图。`);var u=o-s;if(0==u)throw new v(`要回退到的目标视图 ${t} 即为当前视图。`);if(u>0)throw new v(`要回退到的目标视图 ${t} 在当前视图的后面，应该用前进。`);return u}}}),q("Navigator/Meta",function(e,t,n){e("$"),e("String"),e("Date");var r={};return{create:function(e,n){var i=e.id;if(!i)throw new v(`创建 ${t.parent.id} 实例时，必须指定 id 字段。`);if(r[i])throw new v(`${t.parent.id} 已存在 id 为 ${i} 的实例。`);r[i]=!0;var a=n.storage,o=a&&a.get("hash$info")||{},s={id:i,hash:"",fireEvent:!0,rendered:!1,enabled:e.enabled,hash$info:o,infos:[],storage:null,emitter:null,router:null,this:null};return x.assign(s,n),s}}}),q("Navigator/Hash",function(e,t,n){e("$"),e("String"),e("Date");var i=e("Hash");return{init:function(e){var t=e.emitter;i.onchange(r,!0,function(n,r,i){if(e.hash=n,e.enabled)if(e.fireEvent){if(i&&t.fire("immediate",[n,e.hash$info]),!n)return r=e.router.toView(r),void t.fire("none",[r]);var a=e.hash$info[n],o=e.hash$info[r];if(a){var s=!0;if("cache"in a&&(s=a.cache,delete a.cache),t.fire("view",[a.view,a.args,{target:a,current:o,cache:s}]),o){var u=a.timestamp>o.timestamp?"forward":"back";t.fire(u,[o.view,a.view])}}else n=e.router.toView(n),r=e.router.toView(r),i?t.fire("start",[n,r]):t.fire("404",[n,r])}else e.fireEvent=!0})},set:function(e){i.set(r,e)}}}),q("Navigator/Infos",function(e,t,n){e("$"),e("String");var r=e("Date");return{set:function(e,t,n){var i=e.router.toHash(t),a=e.hash$info,o=e.storage,s=new g,u=r.stringify(s),l=s.getTime(),c=a[i]={view:t,hash:i,datetime:u,timestamp:l,args:n||[]};return e.infos=function(e){var t=x.keys(e).map(function(t){return e[t]});return t=t.sort(function(e,t){return e.timestamp>t.timestamp?1:-1})}(a),o&&o.set("hash$info",a),c},get:function(e,t){var n=e.hash$info;if("string"==typeof t)return n[e.router.toHash(t)];var r=t,i=e.infos;if("number"!=typeof r)return i;var a=n[e.hash];return i[i.findIndex(function(e){return e===a})+r]}}}),q("Navigator/Router",function(e,t,n){e("$"),e("String");return{create:function(){var e={view$hash:{},hash$view:{},view2hash:null,hash2view:null,toHash:function(t){var n=t;if(t in e.view$hash?n=e.view$hash[t]:"function"==typeof e.view2hash&&(n=e.view2hash(t)),"string"!=typeof(n=n||""))throw new v("自定义的 view -> hash 的转换关系中，hash 必须为 string 类型。");return n},toView:function(t){var n=t;if(t in e.hash$view?n=e.hash$view[t]:"function"==typeof e.hash2view&&(n=e.hash2view(t)),"string"!=typeof(n=n||""))throw new v("自定义的 hash -> view 的转换关系中，view 必须为 string 类型。");return n}};return e}}}),q("Navigator/Storage",function(e,t,n){e("$"),e("String");return{create:function(n){var r=n.storage,i=n.id;if(!r)return null;var a="session"==(r=r.toLowerCase())?e("SessionStorage"):"local"==r?e("LocalStorage"):null;if(!a)throw new v(`${t.id} 不支持 Storage 类型: ${r}，请指定为 'session' 或 'local'。 `);return r=new a(i)}}}),q("SessionStorage",function(e,t,n){var r=e("Storage"),i=e("Defaults"),a=r("session"),o=new w;function s(e,n){var r=(n=i.clone(t.id,n)).name;if(!r)throw new v(`KISP.${t.id} 是针对多个应用的存储，每个应用都有自己独立的存储空间。\n                请先指定所在应用的名称(通过配置 ${t.id} 模块的 name 字段) 。`);var a={name:r,id:e};o.set(this,a)}return s.prototype={constructor:s,set:function(e,t){var n=o.get(this),r=a.get(n.name)||{},i=r[n.id]||{};"object"==typeof e?x.assign(i,e):i[e]=t,r[n.id]=i,a.set(n.name,r)},get:function(e){var t=o.get(this),n=(a.get(t.name)||{})[t.id];if(n)return 0==arguments.length?n:n[e]},remove:function(e){var t=o.get(this),n=a.get(t.name)||{},r=n[t.id];r&&(delete r[e],a.set(t.name,n))},clear:function(){var e=o.get(this),t=a.get(e.name);t&&(delete t[e.id],a.set(e.name,t))}},x.assign(s,a)}),q("SessionStorage.defaults",{name:""}),q("Storage",function(e,t,n){var i=e("CircularJSON"),a={};return function(t){var n=a[t];if(n)return n;var o=`${t}Storage`,s=r[o];if(!s)throw new v(`当前浏览器不支持 ${o} 存储。`);var u=e("KISP"),l=`KISP.${u.name}.(${u.version}).${u.md5}`,c=s.getItem(l)||"{}",f=i.parse(c)||{};function d(){c=i.stringify(f),s.setItem(l,c)}return a[t]={set:function(e,t){f[e]=t,d()},get:function(e){return f[e]},remove:function(e){delete f[e],d()},clear:function(){f={},d()}}}}),q("CircularJSON",function(e,t,n){var r="~",i="\\x"+("0"+r.charCodeAt(0).toString(16)).slice(-2),a="\\"+i,o=new S(i,"g"),s=new S(a,"g"),u=new S("(?:^|([^\\\\]))"+a),l=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},c=k;function f(e,t,n){return t instanceof h?function(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r]=f(e,t[r],n);return t}(e,t,n):t instanceof c?t.length?n.hasOwnProperty(t)?n[t]:n[t]=function(e,t){for(var n=0,i=t.length;n<i;e=e[t[n++].replace(s,r)]);return e}(e,t.split(r)):e:t instanceof x?function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&(t[r]=f(e,t[r],n));return t}(e,t,n):t}var d={stringify:function(e,t,n,s){return d.parser.stringify(e,function(e,t,n){var s,u,c=!1,f=!!t,d=[],h=[e],p=[e],g=[n?r:"[Circular]"],v=e,m=1;return f&&(u="object"==typeof t?function(e,n){return""!==e&&t.indexOf(e)<0?void 0:n}:t),function(e,t){return f&&(t=u.call(this,e,t)),c?(v!==this&&(s=m-l.call(h,this)-1,m-=s,h.splice(m,h.length),d.splice(m-1,d.length),v=this),"object"==typeof t&&t?(l.call(h,t)<0&&h.push(v=t),m=h.length,(s=l.call(p,t))<0?(s=p.push(t)-1,n?(d.push((""+e).replace(o,i)),g[s]=r+d.join(r)):g[s]=g[0]):t=g[s]):"string"==typeof t&&n&&(t=t.replace(i,a).replace(r,i))):c=!0,t}}(e,t,!s),n)},parse:function(e,t){return d.parser.parse(e,function(e){return function(t,n){var o="string"==typeof n;return o&&n.charAt(0)===r?new c(n.slice(1)):(""===t&&(n=f(n,n,{})),o&&(n=n.replace(u,"$1"+r).replace(a,i)),e?e.call(this,t,n):n)}}(t))},parser:y};return d}),q("LocalStorage",function(e,t,n){var r=e("Storage"),i=e("Defaults"),a=r("local"),o=new w;function s(e,n){var r=(n=i.clone(t.id,n)).name;if(!r)throw new v(`KISP.${t.id} 是针对多个应用的存储，每个应用都有自己独立的存储空间。\n                请先指定所在应用的名称(通过配置 ${t.id} 模块的 name 字段) 。`);var a={name:r,id:e};o.set(this,a)}return s.prototype={constructor:s,set:function(e,t){var n=o.get(this),r=a.get(n.name)||{},i=r[n.id]||{};"object"==typeof e?x.assign(i,e):i[e]=t,r[n.id]=i,a.set(n.name,r)},get:function(e){var t=o.get(this),n=(a.get(t.name)||{})[t.id];if(n)return 0==arguments.length?n:n[e]},remove:function(e){var t=o.get(this),n=a.get(t.name)||{},r=n[t.id];r&&(delete r[e],a.set(t.name,n))},clear:function(){var e=o.get(this),t=a.get(e.name);t&&(delete t[e.id],a.set(e.name,t))}},x.assign(s,a)}),q("LocalStorage.defaults",{name:""}),q("ViewSlider",function(e,t,n){e("String"),e("Defaults"),e("Emitter");var r=t.require("Jump"),i=t.require("Slide");return{back:r.back,forward:r.forward,slide:function(e,t){"boolean"==typeof t?i.enable(e,t):i.bind(...arguments)}}}),q("ViewSlider.defaults",{left:.6,right:.25,time:400,mask:.1,gradient:.6}),q("ViewSlider/Jump",function(e,t,n){var r=e("String"),a=e("Defaults"),o=e("TransitionEnd"),s=new(e("Mask"))({opacity:0});function u(e){var n=a.clone(t.parent.id,e),r=100*-n.left+"%",i=n.time/1e3+"s";return l.log(r,i),{time:i,leftPercent:r}}function c(e,t,n){e.$.css({transform:`translateX(${n})`,transition:`transform ${t}`,"-webkit-transition":`-webkit-transform ${t}`})}function d(e,t){e.$.css("z-index",1),t.$.css("z-index",3)}return{back:function(e,n,a){var l=(a=u(a)).time,h=a.leftPercent,p=t.id+".back."+r.random();i.activeElement.blur(),o.bind(e,p,function(t){e.$.removeClass("Shadow"),e.hide()}),o.bind(n,p,function(e){n.show(),s.hide()}),d(n,e),n.$.css({transform:`translateX(${h})`,transition:"none","-webkit-transition":"none"}),n.show(),s.show(),f(function(){o.active(e,p),o.active(n,p),e.$.addClass("Shadow"),c(e,l,"100%"),c(n,l,"0px")},50)},forward:function(e,n,a){var l=(a=u(a)).time,h=a.leftPercent,p=t.id+".forward."+r.random();i.activeElement.blur(),o.bind(e,p,function(t){e.hide()}),o.bind(n,p,function(e){s.hide()}),d(e,n),n.$.css({transform:"translateX(100%)",transition:"none","-webkit-transition":"none"}),n.$.show(),s.show(),f(function(){o.active(n,p),o.active(e,p),n.$.addClass("Shadow"),c(n,l,"0px"),c(e,l,h)},50)}}}),q("TransitionEnd",function(e,t,n){e("$"),e("String");var r=t.require("Data"),i=t.require("EventName"),a="";return{bind:function(e,t,n){var o=r.get(e),s=o.sid$fn;s[t]=n,o.binded||(o.binded=!0,a=a||i.get(),e.$.on(a,function(t){if(t.target===this){var n=o.sid,r=s[n];r&&(l.log(n,e),delete s[n],r.call(this,t))}}))},active:function(e,t){r.get(e).sid=t}}}),q("TransitionEnd/Data",function(e,t,n){var r=new w;return{get:function(e){var t=r.get(e);return t||(t={binded:!1,sid:"",sid$fn:{}},r.set(e,t)),t}}}),q("TransitionEnd/EventName",function(e,t,n){var r={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};var a="";return{get:function(){var e,t;return a||(e=i.createElement("div"),t=x.keys(r).find(function(t){return e.style[t]!==T}),a=r[t]),a}}}),q("Mask",function(e,t,n){var r=e("Emitter"),i=e("String"),a=e("Defaults"),o=t.require("Sample"),s=t.require("Style"),u=t.require("Meta"),l=new w;function c(e){e=a.clone(t.id,e);var n=new r(this),i=s.get(e),c=u.create(e,{sample:o,style:i,emitter:n,this:this});l.set(this,c),x.assign(this,{id:c.id})}return c.prototype={constructor:c,id:"",$:null,render:function(){var t=l.get(this);if(!t.$){var n=e("Style").stringify(t.style),r=i.format(t.sample,{id:t.id,style:n});C(t.container).append(r),this.$=t.$=C(`#${t.id}`),t.bindVolatile(function(){if(!1!==t.this.hide()){var e=t.$.css("opacity");t.$.css("opacity",0),t.this.show({quiet:!0}),f(function(){t.$.css("opacity",e),t.$.hide()},200)}}),t.emitter.fire("render")}},show:function(e){e=e||{};var t=l.get(this),n="duration"in e?e.duration:t.duration,r="fadeIn"in e?e.fadeIn:t.fadeIn;t.$||this.render(),n&&f(function(){t.this.hide()},n),r&&t.$.css("opacity",0),t.$.show(),r&&t.$.animate({opacity:t.opacity},r),e.quiet||t.emitter.fire("show")},hide:function(e){e=e||{};var t=l.get(this),n="fadeOut"in e?e.fadeOut:t.fadeOut;if(t.$){if(t.emitter.fire("hide").includes(!1))return!1;n?t.$.animate({opacity:0},n,function(){t.$.css("opacity",t.opacity),t.$.hide()}):t.$.hide()}},remove:function(){var e=l.get(this);if(e.$){var t=e.$.get(0);t.parentNode.removeChild(t),e.$.off(),this.$=e.$=null,e.emitter.fire("remove")}},on:function(...e){l.get(this).emitter.on(...e)},destroy:function(){var e=l.get(this);this.remove(),e.emitter.destroy(),l.delete(this)}},x.assign(c,{normalize:function(e,t){if(!1===t)return null;"number"==typeof e&&(e={opacity:e}),"number"==typeof t&&(t={opacity:t});var n=typeof e,r=typeof t;return"object"==n&&"object"==r?x.assign({},e,t):!0===t?e&&"object"==n?e:{}:t===T?"object"==n?e:e?{}:null:"object"==r?t:t?{}:null}}),c}),q("Mask.defaults",{volatile:!1,container:"body",eventName:"click",duration:0,fadeIn:0,fadeOut:0,cssClass:"",opacity:.5,"z-index":1024,style:{}}),q("Mask.config",{eventName:"touch"}),q("Style",function(e,t,n){var r=e("Object");function i(e){if("number"==typeof e)return e+"px";if("string"==typeof e){var t=/^\d+px$/g.test(e),n=/^\d+em$/g.test(e),r=/^\d+rem$/g.test(e),i=/^\d+%$/g.test(e);if(t||n||r||i)return e;var a=parseInt(e);return isNaN(a)?e:a+"px"}return e}return n={objectify:function(e){if(!e)return{};if("object"==typeof e)return e;if("string"!=typeof e)return{};var t={};return e.split(";").forEach(function(e){if(e=(e=e.trim()).replace(/\n/g,"")){var n=e.split(":"),r=n[0].trim(),i=n[1].trim();t[r]=i}}),t},stringify:function(e,t,i){if(!e)return"";"string"==typeof e&&(e=n.objectify(e)),"number"==typeof t&&(i=t,t=null);var a=[];return r.each(e,function(e,n){if(null!=(n=t?t(e,n):n)&&""!==n){var r=e+": "+n;i&&(r=new h(i+1).join(" ")+r),a.push(r)}}),0==a.length?"":e=i?a.join("; \n")+"; \n":a.join("; ")+"; "},pixelize:function(e,t){return"object"==typeof e||t?(t=t||[],e=n.objectify(e),e=r.map(e,function(e,n){return t.includes(e)?i(n):n})):i(e)},trim:function(e){var t={};return r.each(e,function(e,n){null!=n&&""!==n&&(t[e]=n)}),t},merge:function(...e){return e=e.map(function(e){return e?e=n.trim(e):{}}),x.assign(...e)}}}),q("Mask/Sample",['<div id="{id}" class="KISP Mask" style="{style} display: none;"></div>'].join("\n")),q("Mask/Style",function(e,t,n){var r=e("Object"),i=e("Style");return{get:function(e){var t=r.filter(e,["opacity","z-index"]),n=i.objectify(e.style);return n=i.merge(n,t)}}}),q("Mask/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId");return{create:function(e,t){var n=r.get("KISP-Mask-",4),i=e.eventName,a=e.volatile,o={id:n,sample:"",eventName:i,volatile:a,container:e.container,duration:e.duration,fadeIn:e.fadeIn,fadeOut:e.fadeOut,opacity:e.opacity,emitter:null,style:null,this:null,$:null,bindVolatile:function(e){a&&("touch"==i?o.$.touch(e):o.$.on(i,e))}};return x.assign(o,t),o}}}),q("RandomId",function(e,t,n){var r=e("String");return{get:function(...e){return(e=e.map(function(e,t){return"number"==typeof e&&(e=(e=r.random(e)).toLowerCase()),e})).join("")}}}),q("ViewSlider/Slide",function(e,t,n){var r=e("Fn"),a=e("Defaults"),o=t.require("TransitionEnd"),s=t.require("Gradient"),u=t.require("Touch"),l=new w,c=a.clone(t.parent.id),f=100*-c.left+"%",d=c.time/1e3+"s";return{bind:function(e,t,n){var a=l.get(e);if(a&&a.sid)return x.assign(a,{target:t,args:n.args||a.args,abort:n.abort||a.abort,back:n.back||a.back,done:n.done||a.done}),void(a.sid=o.bind(e,a));var h={sid:"",target:t,disabled:!1,args:n.args||[],abort:n.abort||r.noop,back:n.back||r.noop,done:n.done||r.noop,startX:0,startY:0,deltaX:0,clientWidth:0,ready:!1,aborted:!1,masker:null,masker2:null};a?x.assign(a,h,a):a=h,l.set(e,a),a.sid=o.bind(e,a),e.$.on("touchstart",function(e){if(!a.disabled){var t=e.originalEvent.touches[0];a.startX=t.pageX,a.startY=t.pageY,a.deltaX=0,a.clientWidth=i.body.clientWidth,a.ready=!1,a.aborted=!1,a.masker=null,a.masker2=null}}),e.$.on("touchmove",function(t){if(!a.disabled){var n=t.originalEvent.touches[0],r=a.deltaX=n.pageX-a.startX;if(!(r<=0)){if(!a.ready){if(s.get(n.pageY,a.startY,r)>c.gradient)return;a.ready=!0,i.activeElement.blur(),u.ready(e,a.target,{args:a.args,leftPercent:f})}u.move(e,a.target,{left:c.left,mask:c.mask,deltaX:r,clientWidth:a.clientWidth})}}}),e.$.on("touchend",function(t){if(a.ready&&!a.disabled){a.ready=!1,o.active(e,a.sid);var n=u.end(e,a.target,{deltaX:a.deltaX,mask:c.mask,right:c.right,time:d,leftPercent:f,clientWidth:a.clientWidth});x.assign(a,n)}})},enable:function(e,t){e.module&&(e=e.module.exports);var n=l.get(e);n||(n={},l.set(e,n)),n.disabled=!t}}}),q("ViewSlider/Slide/TransitionEnd",function(e,t,n){var r=e("String"),i=e("TransitionEnd"),a={transform:"translateX(0)",transition:"none","-webkit-transition":"none"};return n={bind:function(e,o){var s=o.sid;return s||(s=t.id+".bind."+r.random(),i.bind(e,s,function(t){o.sid="",o.masker.hide(),o.masker2.hide(),o.aborted?(o.sid=n.bind(e,o),o.target.hide(),o.abort(),o.done(o.aborted)):(e.$.removeClass("Shadow"),e.hide(),e.$.css(a),o.back(),o.done(o.aborted))}),s)},active:function(e,t){i.active(e,t)}}}),q("ViewSlider/Slide/Gradient",function(e,t,n){return{get:function(e,t,n){var r=(e-t)/n;return b.abs(r)}}}),q("ViewSlider/Slide/Touch",function(e,t,n){var r=e("Mask"),i=new r({"z-index":2,fadeIn:!1,fadeOut:!1}),a=new r({"z-index":4,opacity:0,fadeIn:!1,fadeOut:!1}),o={transition:"none","-webkit-transition":"none"};function s(e,t,n){e.$.css({transform:`translateX(${n})`,transition:`transform ${t}`,"-webkit-transition":`-webkit-transform ${t}`})}return{ready:function(e,t,n){var r=t.rendered(),a=n.args||[];r||t.render(...a),i.render(),e.$.css("z-index",3),t.$.css("z-index",1),e.$.css(o),i.$.css(o),t.$.css(o),e.$.addClass("Shadow"),t.$.css("transform",`translateX(${n.leftPercent})`),t.show(),i.show()},move:function(e,t,n){var r=n.deltaX,a=n.left,o=n.mask,s=n.clientWidth,u=o*(1-2*r/s),l=(r-s)*a;u=b.max(u,0),l=b.min(l,0),e.$.css("transform",`translateX(${r}px)`),i.$.css("opacity",u),t.$.css("transform",`translateX(${l}px)`)},end:function(e,t,n){var r=n.right,o=n.clientWidth;r<1&&(r*=o);var u=n.deltaX<r,l=n.mask,c=n.leftPercent,f=n.time;return i.$.css({opacity:u?l:0,transition:`opacity ${f}`}),a.show(),s(e,f,u?0:"100%"),s(t,f,u?c:0),{aborted:u,masker:i,masker2:a}}}}),q("App/Navigator/Views",function(e,t,n){var r=e("Tasks"),i=e("Array"),a=e("Package"),o={};return{load:function(e,t,n){var s=function(e){return e=h.isArray(e)?e:[e],e=i.map(e,function(e){return e?("string"==typeof e&&(e={view:e,args:[]}),e):null})}(e),u=t.module,l=t.container,c=new r(s);c.on("each",function(e,t,n){var r=e.view,i=u.require(r);i?n(i):a.load(r,function(e){if(!e)throw new v(`总包中不存在名为 ${r} 的配置节点。`);var t=(e.html||{}).content;!o[r]&&l&&t&&(o[r]=!0,C(l).append(t));var i=u.require(r);if(!i)throw new v(`不存在名为 ${r} 的视图模块`);n(i)})}),c.on("all",function(e){n&&n(...e)}),c.parallel()}}}),q("Package",function(e,t,n){e("$");var r=e("Tasks"),i=e("Session"),a=e("Defaults"),o=t.require("All"),s=t.require("Loader"),u=a.clone(t.id),c={},f=null,d=`KISP.${t.id}.${i.id}`;return{load:function(t,n){if("function"==typeof t)return n=t,void o.load(u,n);var i=c[t];if(i||null===i)n&&n(i);else{var a={done:n},h=`${t}@${d}`;r.todo(h,a,function(n){!function(t,n,r){var i=n.load||{},a=i.begin,u=i.end;a&&(f=a(e,f)),o.load(n,function(i){var a=i[t];if(!a)return l.warn(`总包  ${n.url} 中不存在名为 ${t} 的配置节点。`),u&&u(e,f),void(r&&r(null));s.load(a,function(t){u&&u(e,f),r&&r(t)})})}(t,u,function(e){c[t]=e?x.assign({},e,{cache:!0}):null,n(function(t){t.done(e)})})})}}}}),q("Package.defaults",{url:"packages/all.json",random:!0,query:null,load:{begin:function(e,t){t||(t=new(e("Loading")));return t.show(),t},end:function(e,t){t.hide()}}}),q("Loading",function(e,t,n){var r=e("String"),i=e("Emitter"),a=e("Defaults"),o=t.require("Sample"),s=t.require("Style"),u=t.require("Meta"),l=t.require("Masker"),c=t.require("Presettings"),d=new w;function h(e){var n=c[(e=e||{}).presetting]||{},r=a.clone(t.id,n,e),f=new i(this),h=o.get(r.sample),p=s.get(r),g=l.create(r),v=u.create(r,{sample:h,style:p,emitter:f,masker:g,this:this});d.set(this,v),x.assign(this,{id:v.id})}return h.prototype={constructor:h,id:"",$:null,render:function(){var t=d.get(this);if(!t.$){e("Style");var n=r.format(t.sample,{id:t.id,text:t.text,textId:t.textId,cssClass:t.cssClass});C(t.container).append(n),t.$=this.$=C(`#${t.id}`),t.$text=C(`#${t.textId}`),t.$.css(t.style),t.emitter.fire("render")}},show:function(e,t){"function"==typeof e&&(t=e,e=T);var n=d.get(this),r=n.masker,i=n.duration;n.$||this.render(),r&&r.show(),"string"==typeof e&&(n.text=e,n.$text.html(e)),i&&f(function(){n.this.hide(),t&&t()},i),n.$.toggleClass("NoText",!n.text),n.$.show(),n.emitter.fire("show")},hide:function(){var e=d.get(this),t=e.masker;e.$&&(t&&t.hide(),e.$.hide(),e.emitter.fire("hide"))},remove:function(){var e=d.get(this);if(e.$){var t=e.$.get(0),n=e.masker;t.parentNode.removeChild(t),n&&n.remove(),e.$.off(),e.$=this.$=null,e.$text=null,e.masker=null,e.emitter.fire("remove")}},on:function(...e){d.get(this).emitter.on(...e)},destroy:function(){var e=d.get(this);this.remove(),e.emitter.destroy(),d.remove(this)}},h}),q("Loading.defaults",{text:"处理中...",mask:!1,sample:"IOS",container:"body",duration:0,cssClass:"","z-index":1024,width:"",height:"",style:{}}),q("Loading/Sample",function(e,t,n){return{get:function(e){return t.require(e)}}}),q("Loading/Style",function(e,t,n){var r=e("Object"),i=e("Style");return{get:function(e){var t=r.filter(e,["height","width","z-index"]),n=i.objectify(e.style);return n=i.merge(n,t),n=i.pixelize(n,["height","width"])}}}),q("Loading/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId");return{create:function(e,t){var n={id:r.get("KISP-Loading-",4),textId:r.get("KISP-Loading-","text-",4),text:e.text||"",cssClass:e.cssClass||"",container:e.container,duration:e.duration||0,sample:"",masker:null,style:null,emitter:null,this:null,$:null,$text:null};return x.assign(n,t),n}}}),q("Loading/Masker",function(e,t,n){e("$");return{create:function(t){var n=e("Mask"),r={container:t.container},i=n.normalize(r,t.mask);if(!i)return null;var a=new n(i),o=t["z-index"]-1;return a.on("render",function(){a.$.css({"z-index":o})}),a}}}),q("Loading/Presettings",{fullscreen:{cssClass:"FullScreen"},"scroller.pulldown":{sample:"IOS",cssClass:"SameLine Pulldown",text:"加载中..."},"scroller.pullup":{sample:"IOS",cssClass:"SameLine Pullup",text:"加载中..."}}),q("Session",function(e,t,n){var r=e("String"),i=e("Defaults").get(t.id).length||16;return{id:r.random(i)}}),q("Session.defaults",{length:16}),q("Package/All",function(e,t,n){var r=e("$"),i=e("Query"),a=e("Url"),o=e("Tasks"),s=e("Session"),u=`all@KISP.${t.id}.${s.id}`,l=null;function c(e,t){var n=function(e){var t=a.root()+e.url,n=e.query;return"string"==typeof n&&(n=i.parse(n)),n&&(t=i.add(t,n)),e.random&&(t=i.random(t,4)),t}(e);r.ajax({type:"get",dataType:"json",url:n,error:function(){l={},t&&t(l)},success:function(e){l=e,t&&t(l)}})}return{load:function(e,t){l?t&&t(l):o.todo(u,t,function(t){c(e,function(e){t(function(t){t&&t(e)})})})}}}),q("Package/Loader",function(e,t,n){var r=e("Tasks");var a={css:function(e,t){var n=i.createElement("link");n.onerror=function(){throw new v(`css 文件加载失败: ${e}`)},n.onload=function(){t&&t({url:e,content:""})},n.rel="stylesheet",n.href=e,i.head.appendChild(n)},html:function(e,t){C.ajax({type:"get",url:e,dataType:"html",cache:!0,error:function(e,t,n){throw n},success:function(n,r,i){t&&t({url:e,content:n})}})},js:function(e,t){C.ajax({type:"get",url:e,dataType:"script",cache:!0,error:function(e,t,n){throw n},success:function(n,r,i){t&&t({url:e,content:n})}})},json:function(e,t){C.ajax({type:"get",dataType:"json",url:e,error:function(){t&&t({})},success:function(e){t&&t(e)}})}};return{load:function(e,t){var n=x.keys(e);r.parallel(n,{each:function(t,n,r){var i=e[t],o=a[t];if(!o)throw new v(`不支持加载 ${t} 类型的文件。`);o(i,function(e){r({type:t,url:e.url,content:e.content})})},all:function(e){var n={cache:!1};e.forEach(function(e){n[e.type]=e}),t&&t(n)}})}}}),q("View",function(e,t,n){var r=e("Defaults"),i=e("Panel"),a=e("ViewSlider"),o=r.get(t.id);e("Mapper");function s(e,n){n=r.clone(t.id,n),i.call(this,e,n),this.$.addClass("KISP View"),n.fullscreen&&this.$.addClass("FullScreen"),n.background&&this.$.css("background",n.background)}return s.prototype=x.assign(new i,{slider:function(e){a.slide(this,e)}}),x.assign(s,{define:function(e,t){i.define(e,t,{constructor:s,defaults:o})},update:function(e){i.update(e,{defaults:o})}})}),q("View.defaults",{container:'[data-view="{id}"]',background:"",fullscreen:!1}),q("View.config",{fullscreen:!0}),q("Panel",function(e,t,n){var r=e("Object"),i=e("Emitter"),a=e("Defaults"),o=e("OuterModule"),s=e("Template"),u=t.require("Meta"),c=t.require("Container"),f=t.require("Params"),d=e("Mapper"),p={},g=a.clone(t.id);function m(e,n){n=a.clone(t.id,n);var r=u.create(n,{moudle:null,container:e,tplContainer:e,$emitter:new i,emitter:new i(this),$:C(e),this:this});d.set(this,r),x.assign(this,{container:e,id:r.id,$:r.$})}return m.prototype={constructor:m,container:"",id:"",$:null,module:null,render:function(...e){var t=d.get(this),n=t.emitter;t.renderArgs=e,t.rendered||(t.rendered=!0,n.fire("init")),n.fire("before-render",e),n.fire("render",e),t.show&&this.show(),n.fire("after-render",e)},show:function(...e){var t=d.get(this);return t.$.show(...e),t.visible=!0,t.emitter.fire("show")},hide:function(...e){var t=d.get(this);return t.$.hide(...e),t.visible=!1,t.emitter.fire("hide")},toggle:function(e){var t=d.get(this);return 0==arguments.length?t.visible?this.hide():this.show():e?this.show():this.hide(),t.visible},template:function(e){var t=d.get(this),n=t.tpl;return n||(n=t.tpl=new s(t.tplContainer)),e&&n.process(...arguments),n},fill:function(e,t){var n=d.get(this);return this.template(),n.tpl.render(e,t),n.emitter.fire("fill",[e])},refresh:function(){var e=d.get(this),t=e.renderArgs;return this.render(...t),e.emitter.fire("refresh",t)},reset:function(...e){return d.get(this).emitter.fire("reset",e)},visible:function(){return d.get(this).visible},rendered:function(){return d.get(this).rendered},fire:function(...e){return d.get(this).$emitter.fire(...e)},$on:function(e,t,n){var i=f.normalize(e,t,n);if(i){var a=d.get(this);r.each(i,function(e,t){t&&("function"!=typeof t?r.each(t,function(t,n){a.$.on(e,t,n)}):a.$.on(e,t))})}},$bind:function(e,t){var n=null;if("string"==typeof e)n={[e]:t};else{if("object"!=typeof e)throw new v("无法识别参数 selector 的类型。");n=e}if(n){var i=d.get(this);r.each(n,function(e,t){t&&r.each(t,function(t,n){i.$.on(t,e,n)})})}},wrap:function(e){var t=d.get(this),n=t.panel;if(n)return n;e=e||{},n=t.panel={};var i=new Set(["constructor","fire","wrap"]);return r.each(t.this,function(e,r){i.has(e)||("function"==typeof r&&(r=r.bind(t.this)),n[e]=r)}),x.assign(n,e,{on:t.$emitter.on.bind(t.$emitter),off:t.$emitter.off.bind(t.$emitter)}),n},propagate:function(e,t){var n=d.get(this);t.forEach(function(t){e.on(t,function(...e){n.this.fire(t,e)})})},set:function(e,t){var n=d.get(this);if(r.isPlain(e))r.each(e,function(e,t){n.this.set(e,t)});else switch(e){case"show":case"rendered":n[e]=t;break;case"$":case"container":c.set(n,t);break;case"visible":n.visible=!!t;break;case"template":if(n.tpl)throw new v("当前实例中已创建了模板实例，无法再修改模板实例所关联的 DOM 容器。");n.tplContainer=n.$.find(t);break;default:throw new v(`目前不支持设置属性: ${e}`)}},destroy:function(){var e=d.get(this);e.emitter.destroy(),e.$emitter.destroy(),e.$.off(),d.delete(this)},on:function(...e){d.get(this).emitter.on(...e)}},x.assign(m,{define:function(e,t,n){n=n||{constructor:m,defaults:g},o.define(e,function(r,i,a){var o=c.get(e,n.defaults),s=new n.constructor(o);return d.get(s).module=s.module=i,a=t(r,i,s),a=s.wrap(a),p[e]=s,a})},update:function(e,t){e=h.isArray(e)?e:[e],t=t||{defaults:g},e.forEach(function(e){var n=p[e],r=c.get(e,t.defaults);n?n.set("container",r):l.warn(`不存在 ${r} 的 Panel 实例。`)})}}),m}),q("Panel.defaults",{container:'[data-panel="{id}"]',show:!0}),q("Template",function(e,t,n){var r=e("String"),i=e("Object"),a=e("Emitter"),o=t.require("Meta"),s=t.require("Parser"),u=t.require("Sample"),c=t.require("Child"),f=new w;function d(e){var t=i.isPlain(e),n=o.create({emitter:new a(this),this:this});if(f.set(this,n),t){var r=e;o.assign(n,r),n.tpls=r.items.map(function(e){return c.create(d,n,e)})}else{var l=C(e).get(0);if(!l)throw e=e instanceof C?e.selector:e,new v("不存在模板节点: "+e);var h="template"==l.nodeName.toLowerCase(),p=l.innerHTML,g=s.parse(p);n.sample=u.between(p),n.name=h?l.getAttribute("name"):"",n.placeholder=h?l.getAttribute("placeholder"):"",n.innerHTML=p,n.outerHTML=l.outerHTML,n.node=l,n.tpls=g.tpls.map(function(e){var t=c.create(d,n,e),r=n.sample;return n.sample=u.replace(r,e),t})}!function(){var e=n.name$tpl[""];if(e){var t=f.get(e);if(x.keys(t.name$tpl).length>0)throw new v("无名称的 template 标签下不能再嵌套子级 template。");if(t.placeholder)throw new v("无名称的 template 标签不能设置 placeholder 属性。");n.sample=t.sample}}(),x.assign(this,{id:n.id,_meta:n})}return d.prototype={constructor:d,id:"",parent:null,template:function(e){h.isArray(e)||(e=[...arguments]);var t=this,n=f.get(t);return e.map(function(e){t=n.name$tpl[e],n=f.get(t)}),t},sample:function(...e){var t=this.template(...e),n=f.get(t);if(!n)throw new v(`当前实例下不存在名称路径为 ${e.join(" ")} 的 Template 子实例。`);return n.sample},render:function(e,t){t&&this.process(t);var n=f.get(this).node,r=this.fill(e);return n&&(n.innerHTML=r),r},fill:function(e,...t){var n=[...arguments],a=n.findIndex(function(e){return h.isArray(e)||i.isPlain(e)});if(a<0)throw new v("填充模板时必须指定数据为一个数组或纯对象。");if(a>0){var o=n.slice(0,a),s=this.template(...o);if(!s)throw new v(`不存在路径为 ${o.join(".")} 的模板节点，请检查 html 模板树。`);var u=n.slice(a);return s.fill(...u)}var l=f.get(this);return h.isArray(e)?e.map(function(e,n){var i=[e,n,...t];l.emitter.fire("process",i);var a=l.process.apply(l.this,i);return"string"==typeof a?a:a?r.format(l.sample,a):""}).join(""):(l.emitter.fire("process",n),"string"==typeof(e=l.process.apply(l.this,n))?e:r.format(l.sample,e))},process:function(e){var t=f.get(this);if("function"!=typeof e){var n=[...arguments],r=n.findIndex(function(e){return"function"==typeof e||i.isPlain(e)});if(r<0)throw new v(`模板节点 ${t.name} 缺少处理器。`);if(r>0){var a=n.slice(0,r),o=n[r];e=i.make({},a,o)}i.flat(e).forEach(function(e){var n=e.keys.filter(function(e){return!!e}),r=e.value;if("function"!=typeof r)throw new v(`模板节点 ${n.join(".")} 的处理器必须为一个函数。`);var i=t.this.template(n);i?i.process(r):l.warn(`不存在模板节点: ${n.join(".")}`)})}else t.process=e},fix:function(e){var t=f.get(this),n=t.sample;(e=h.isArray(e)?e:[e]).map(function(e){var t="{"+e+"}",r=t+'=""';n=n.split(r).join(t)}),t.sample=n},on:function(...e){f.get(this).emitter.on(...e)},destroy:function(){var e=f.get(this);e&&(e.tpls.map(function(e){e.destroy()}),e.emitter.destroy(),e.node=null,e.parent=null,e.emitter=null,f.delete(this))}},x.assign(d,{create:function(t){return t=`<template>${t}</template>`,new d(e("HTMLParser").parse(t).childNodes[0])}}),d}),q("HTMLParser",function(e,t){var n={},r={},a=/([a-z0-9_\:\-]*)\s*?=\s*?(['"]?)(.*?)\2\s+/gim,o=/(?:<(\/?)([a-zA-Z][a-zA-Z0-9\:]*)(?:\s([^>]*?))?((?:\s*\/)?)>|(<\!\-\-)([\s\S]*?)(\-\->)|(<\!\[CDATA\[)([\s\S]*?)(\]\]>))/gm;function s(){this.childNodes=[]}function u(){}function c(){s.call(this)}function f(){}function d(){}function p(){}return r.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r.inherit=function(e,t){var n=e.prototype;function i(){}i.prototype=t.prototype,e.prototype=new i,r.extend(e.prototype,n),e.prototype.constructor=e},r.selfClosingTags={img:1,br:1,hr:1,meta:1,link:1,base:1,input:1},r.getElementsByTagName=function(e,t){var n,i,a=[],o=0;if(t||(t="*"),t=t.toLowerCase(),e.childNodes)for(n=0;n<e.childNodes.length;n++)1!==(i=e.childNodes[n]).nodeType||"*"!==t&&i.nodeName!==t||(a[o++]=i),h.prototype.splice.apply(a,[a.length,0].concat(r.getElementsByTagName(i,t))),o=a.length;return a},r.splitAttrs=function(e){var t,n={};if(e)for(a.lastIndex=0,e=" "+(e||"")+" ";t=a.exec(e);)n[t[1]]=t[3];return n},r.ta=i.createElement("textarea"),r.encodeEntities=function(e){return r.ta.value=e||"",r.ta.innerHTML},r.decodeEntities=function(e){return r.ta.innerHTML=e||"",r.ta.value},r.htmlToText=function(e){return e=e.replace(/<\/?[a-z].*?>/gim,""),r.decodeEntities(e)},r.extend(s.prototype,{nodeType:1,textContent:"",getElementsByTagName:function(e){return r.getElementsByTagName(this,e)},getAttribute:function(e){if(this.attributes.hasOwnProperty(e))return this.attributes[e]},setAttribute:function(e,t){var n=(e+"").toLowerCase();this.attributes[e]=t+"","id"!==n&&"name"!==n||(this[n]=t),"class"===n&&(this.className=t)},getElementById:function(e){var t,n=this.getElementsByTagName("*");for(t=n.length;t--;)if(n[t].id===e)return n[t]},appendChild:function(e){e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e)},insertBefore:function(e,t){e.parentNode&&e.parentNode.removeChild(e);for(var n=0;n<this.childNodes.length&&this.childNodes[n]!==t;n++);this.childNodes.splice(n,0,e)},removeChild:function(e){for(var t=this.childNodes.length;t--;)if(this.childNodes[t]===e){this.childNodes.splice(t,1);break}}}),n.HTMLElement=s,r.extend(u.prototype,{toString:function(){return this.textContent}}),r.inherit(c,s),r.extend(c.prototype,{nodeType:9,nodeName:"#document"}),n.Document=c,r.inherit(f,u),r.extend(f.prototype,{nodeType:3,nodeName:"#text"}),n.TextNode=f,r.inherit(d,u),r.extend(d.prototype,{nodeType:8,nodeName:"#comment"}),n.CommentNode=d,r.inherit(p,u),r.extend(p.prototype,{nodeType:4,nodeName:"#cdata-section"}),n.CDATASectionNode=p,r.blockConstructors={"\x3c!--":d,"<![CDATA[":p},n.parse=function(e){var t,n,i,a,u,d,h,p,g,v,m,y,w;for(t=[],o.lastIndex=0,i=n=new c,y=function(){i&&t.length>0&&(a=t[t.length-1],h=(a.documentPosition.closeTag||a.documentPosition.openTag).end,a.parentNode===i&&h&&h<w.documentPosition.openTag.start&&(d=e.substring(h,w.documentPosition.openTag.start))&&(d=r.decodeEntities(d),i.childNodes.push(r.extend(new f,{textContent:d,nodeValue:d,parentNode:i}))))};u=o.exec(e);)p=u[5]||u[8],g=u[6]||u[9],v=u[7]||u[10],"\x3c!--"===p||"<![CDATA["===p?(h=o.lastIndex-u[0].length,(m=r.blockConstructors[p])&&(w=r.extend(new m,{textContent:g,nodeValue:g,parentNode:i,documentPosition:{openTag:{start:h,end:h+p.length},closeTag:{start:o.lastIndex-v.length,end:o.lastIndex}}}),y(),t.push(w),w.parentNode.childNodes.push(w))):"/"!==u[1]?((w=r.extend(new s,{nodeName:(u[2]+"").toLowerCase(),attributes:r.splitAttrs(u[3]),parentNode:i,documentPosition:{openTag:{start:o.lastIndex-u[0].length,end:o.lastIndex}}})).className=w.attributes.class,w.id=w.attributes.id,w.name=w.attributes.name,y(),t.push(w),w.parentNode.childNodes.push(w),u[4]&&u[4].indexOf("/")>-1||r.selfClosingTags.hasOwnProperty(w.nodeName)?(w.documentPosition.closeTag=w.documentPosition.openTag,w.isSelfClosingTag=!0,w.innerHTML="",w.outerHTML=e.substring(w.documentPosition.openTag.start,w.documentPosition.closeTag.end)):i=w):(u[2]+"").toLowerCase()===i.nodeName?(i=(w=i).parentNode,delete w.isSelfClosingTag,w.documentPosition.closeTag={start:o.lastIndex-u[0].length,end:o.lastIndex},w.innerHTML=e.substring(w.documentPosition.openTag.end,w.documentPosition.closeTag.start),w.outerHTML=e.substring(w.documentPosition.openTag.start,w.documentPosition.closeTag.end),w.textContent=r.htmlToText(w.innerHTML)):(u[2]+"").toLowerCase()===t[t.length-1].nodeName&&!0===t[t.length-1].isSelfClosingTag?(w=t[t.length-1],l.warn("HTML Error: discarding dangling </"+u[2]+"> tag. Already closed via: "+w.outerHTML),delete w.isSelfClosing,w.documentPosition.closeTag={start:o.lastIndex-u[0].length,end:o.lastIndex}):l.warn('tag mismatch: "'+u[2]+'" vs "'+w.nodeName+'"',w);return n.documentElement=n.getElementsByTagName("html")[0],n.body=n.getElementsByTagName("body")[0],n},n}),q("Template/Meta",function(e,t,n){e("String"),e("Object");var r=e("RandomId");function i(e){return e}return{create:function(e){var t={id:r.get("KISP-Template-",4),sample:"",name:"",placeholder:"",innerHTML:"",outerHTML:"",tpls:[],name$tpl:{},node:null,parent:null,emitter:null,this:null,process:i};return x.assign(t,e),t},assign:function(e,t){x.assign(e,{sample:t.sample,name:t.name,placeholder:t.placeholder,innerHTML:t.innerHTML,outerHTML:t.outerHTML,node:t.node})}}}),q("Template/Parser",function(e,t,n){var r=e("HTMLParser"),i=t.require("Templates");return{parse:function(e){e=(e=e.split('<script type="text/template">').join("")).split("<\/script>").join("");var t=r.parse(e);return{dom:t,tpls:i.get(t)}}}}),q("Template/Parser/Templates",function(e,t,n){e("String"),e("Object");return{get:function(e){var t=e.getElementsByTagName("template"),n=new w;return t.map(function(e){var t=e.attributes,r=e.innerHTML,i={id:e.id||"",name:e.name||"",placeholder:t.placeholder||"",innerHTML:r,outerHTML:e.outerHTML,node:e,sample:r,parent:null,attributes:t,items:[]};return n.set(e,i),i}).filter(function(e){var t=function(e){for(e=e.parentNode;e;){if("template"==e.nodeName)return e;e=e.parentNode}return null}(e.node),r=n.get(t);if(!r)return!0;e.parent=r,r.items.push(e);var i=r.sample,a=e.outerHTML,o=e.placeholder;o&&(o="{"+o+"}"),r.sample=i.replace(a,o)})}}}),q("Template/Sample",function(e,t,n){var r=e("String");e("Object");return{replace:function(e,t){var n=t.outerHTML,r=t.placeholder;return r&&(r="{"+r+"}"),e=(e=(e=e.split('<script type="text/template">').join("")).split("<\/script>").join("")).replace(n,r)},between:function(e){return e.includes("\x3c!--")&&e.includes("--\x3e")&&(e=r.between(e,"\x3c!--","--\x3e")),e}}}),q("Template/Child",function(e,t,n){e("String"),e("Object");return{create:function(e,t,n){var r=n.name;if(t.name$tpl[r])throw new v("同一级下已存在名为 `"+r+"` 的模板。");var i=new e(n);return t.name$tpl[r]=i,t.parent=t.this,i.parent=t.this,i.on("process",function(){var e=h.from(arguments);t.emitter.fire("process",e)}),i}}}),q("Mapper",function(e,t,n){return new w}),q("Panel/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId");return{create:function(e,t){var n={id:r.get("KISP-Panel-",4),container:"",rendered:!1,renderArgs:[],show:e.show,visible:!1,tplContainer:null,module:null,$:null,$emitter:null,emitter:null,tpl:null,panel:null,this:null};return x.assign(n,t),n}}}),q("Panel/Container",function(e,t,n){var r=e("String");e("Defaults");return{get:function(e,t){return r.format(t.container,{id:e})},set:function(e,t){if(!(t=t||e.$.selector)&&e.module&&(t=e.container),!t)throw new v("设置 container 时，请给参数 value 提供一个有效的值。");e.container=t,e.$.off(),e.$=e.this.$=C(e.container),e.panel&&(e.panel.$=e.$);var n=e.$.find.bind(e.$);e.$.find=function(...e){var t=n(...e);return t.each(function(e){i.documentElement.contains(this)||this.parentNode.removeChild(this)}),t=n(...e)}}}}),q("Panel/Params",function(e,t,n){e("$");var r=e("String"),i=e("Object");return{normalize:function(e,t,n){var a=typeof e;if("object"==a)return e;if("string"!=a)throw new v("无法识别参数 name 的类型。");if("object"==(a=typeof t)||"function"==a)return{[e]:t};if("string"!=a)throw new v("无法识别参数 sample 的类型。");if("function"==(a=typeof n))return{[e]:{[t]:n}};if("object"==a){var o={};return i.each(n,function(e,n){e=r.format(t,{value:e}),o[e]=n}),{[e]:o}}throw new v("无法识别参数 selector$fn 的类型。")}}}),q("Alert",function(e,t,n){var r=e("String"),i=t.require("Dialog"),a=t.require("Sample");return{show:function(e,t,n,o){"object"==typeof e&&(e=y.stringify(e,null,4),e=r.format(a,{text:e}));var s=[...arguments],u=s.findIndex(function(e,t){return"function"==typeof e});u>0?(o=s[u],s=s.slice(0,u)):o=null,e=r.format(...s),i.add(e,o)}}}),q("Alert.defaults",{volatile:!1,mask:!0,autoClose:!0,width:"80%","z-index":99999,buttons:[{text:"确定",cmd:"ok",cssClass:"OK"}]}),q("Alert.config",{width:"80%",scrollable:!0}),q("Alert/Dialog",function(e,t,n){e("String");var r=e("Defaults"),a=t.require("Height"),o=null,s=!1,u=[],l=13;function c(n,f){var d=a.get(n);(o=o||function(){var n=e("Dialog"),a=r.clone(t.parent.id),o=new n({cssClass:"Alert",volatile:a.volatile,mask:a.mask,autoClose:a.autoClose,width:a.width,"z-index":a["z-index"],buttons:a.buttons,scrollable:a.scrollable});return o.on("button","ok",function(){var e=o.data("fn");e&&e()}),o.on({show:function(){s=!0,l=13==l?"enter":"",i.activeElement.blur()},hide:function(){s=!1;var e=u.shift();e&&c(e.text,e.fn),null,l=""}}),C(i).on({keydown:function(e){l=e.keyCode},keyup:function(e){if(13==e.keyCode&&s&&"enter"!=l){o.hide();var t=o.data("fn");t&&t()}}}),o}()).data("fn",f),o.set({content:n,height:d}),o.show()}return{add:function(e,t){s?u.push({text:e,fn:t}):c(e,t)}}}),q("Dialog",function(e,t,n){var r=e("Object"),i=e("Emitter"),a=e("Defaults"),o=e("Scroller"),s=t.require("Style"),u=t.require("Meta"),l=t.require("Masker"),c=t.require("Events"),f=t.require("Template"),d=e("Mapper");function h(e){e=a.clone(t.id,e);var n=new i(this),r=s.get(e),o=l.create(e),c=u.create(e,{style:r,emitter:n,masker:o,this:this});d.set(this,c),x.assign(this,{id:c.id})}return h.prototype={constructor:h,id:"",$:null,render:function(){var e=d.get(this);if(!e.$){var t=f.fill(e);C(e.container).append(t),e.$=this.$=C(`#${e.id}`),e.$header=C(`#${e.headerId}`),e.$article=C(`#${e.articleId}`),e.$content=C(`#${e.contentId}`),e.$footer=C(`#${e.footerId}`),e.scrollable&&(e.scroller=new o(e.$article,e.scrollerConfig),e.scroller.render()),c.bind(e),e.emitter.fire("render")}},show:function(){var e=d.get(this);e.emitter;e.visible?e.scroller&&e.scroller.refresh(200):(e.$||this.render(),e.$.show(),e.visible=!0,e.masker&&e.masker.show(),e.scroller&&e.scroller.refresh(200),e.emitter.fire("show"))},hide:function(){var e=d.get(this);e.$&&e.visible&&(e.$.hide(),e.visible=!1,e.masker&&e.masker.hide(),e.emitter.fire("hide"))},remove:function(){var e=d.get(this);if(e.$){e.masker&&e.masker.remove(),e.layer&&e.layer.remove();var t=e.$.get(0);t.parentNode.removeChild(t),e.$.off(),e.visible=!1,e.masker=null,e.layer=null,e.$=null,e.$header=null,e.$content=null,e.$footer=null,e.emitter.fire("remove")}},on:function(...e){d.get(this).emitter.on(...e)},destroy:function(){var e=d.get(this);if(!e)throw new v("该实例已给销毁，无法再次调用 destroy 方法。");this.remove(),e.emitter.destroy(),e.scroller&&e.scroller.destroy(),d.delete(this)},set:function(e,n){this.render();var i=d.get(this),a=i.scroller,o="object"==typeof e?e:{[e]:n};r.each(o,function(e,n){switch(e){case"title":i.$header.html(n);break;case"content":i.$content.html(n),a&&a.refresh(200);break;case"height":case"width":var r={};r[e]=i[e]=n,r=s.get(r),x.assign(i.style,r),i.$.css(r),a&&a.refresh(300);break;default:throw new v(`${t.id} 目前不支持设置属性: ${e}`)}})},data:function(e,t){var n=d.get(this).data,i=arguments.length;return 0==i?n:r.isPlain(e)?(x.assign(n,e),e):1==i?n[e]:(n[e]=t,t)}},h}),q("Dialog.defaults",{container:"body",mask:!0,autoClose:!0,volatile:!1,title:"",content:"",eventName:"click",cssClass:"","z-index":1024,width:"80%",height:"50%",style:{},buttons:[]}),q("Dialog.config",{eventName:"touch"}),q("Scroller",function(e,t,n){var r=e("$"),a=e("Emitter"),o=e("Object"),s=e("Defaults"),u=e("Fn"),l=t.require("Meta"),c=t.require("IScroll"),f=t.require("Puller"),d=t.require("Pulldown"),h=t.require("Pullup"),p=new w;function g(e,n){o.isPlain(e)&&(e=(n=e).container),n=s.clone(t.id,n);var i=new a(this),u=l.create(n,{container:e,emitter:i,$:r(e),this:this});p.set(this,u),x.assign(this,{id:u.id,$:u.$})}return i.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),g.prototype={constructor:g,id:"",$:null,iscroll:null,render:function(){var e=p.get(this);e.scroller||(e.scroller=this.iscroll=c.create(e.container,e.options),e.$.addClass("KISP Scroller"),e.$.css(e.style),f.bind(e),d.bind(e),h.bind(e))},refresh:function(e,...t){var n=p.get(this).scroller,i=n.indicators||[];u.delay(e,function(){n.refresh(...t),i.forEach(function(e,t){r(e).hide()})})},reset:function(){var e=p.get(this).scroller;e.isWaitingForManualReset=!1,e.resetPosition(e.options.bounceTime)},pulldown:function(e){e="function"==typeof e?{load:e}:e||{};var t=p.get(this),n=x.assign(t.pulldown,e),r=n.min,i=n.max;if(r>i)throw new v("参数 min 的值不能大于参数 max 的值。");if(!r&&!i)throw new v("参数 min 和 max 的值不能全为零。");n.enabled=!0,f.bind(t),d.bind(t)},pullup:function(e){e="function"==typeof e?{load:e}:e||{};var t=p.get(this),n=x.assign(t.pullup,e),r=n.min,i=n.max;if(r>i)throw new v("参数 min 的值不能大于参数 max 的值。");if(!r&&!i)throw new v("参数 min 和 max 的值不能全为零。");n.enabled=!0,f.bind(t),h.bind(t)},to:function(e){var t=p.get(this).scroller,n=t.options;t.scrollTo(0,e,n.bounceTime,n.bounceEasing)},toBottom:function(e){var t=p.get(this).scroller,n=t.options;e=t.maxScrollY-e,t.scrollTo(0,e,n.bounceTime,n.bounceEasing)},enable:function(e){var t=p.get(this);return t.enabled=!!e,t.enabled?t.scroller.enable():t.scroller.disable(),t.enabled},on:function(...e){p.get(this).emitter.on(...e)},destroy:function(){var e=p.get(this);e.emitter.destroy(),e.scroller.destroy(),p.remove(this)}},g}),q("Scroller.defaults",{scrollbars:!0,shrinkScrollbars:"scale",preventDefault:!1,probeType:2,pulldown:{min:35,max:85,top:10,release:50,translateY:-40,tips:{start:"↓ 下拉刷新",reach:"↑ 释放立即刷新",loading:"加载中...",success:"刷新成功"},load:null},pullup:{min:35,max:85,bottom:10,release:50,translateY:40,lastPage:!1,tips:{start:"↑ 上拉加载更多",reach:"↓ 释放立即加载",loading:"加载中...",lastPage:"已是最后一页"},load:null}}),q("Scroller/Meta",function(e,t,n){e("$");var r=e("Object"),i=e("RandomId");return{create:function(e,t){var n=i.get("KISP-Scroller-",4),a=r.filter(e,["scrollbars","shrinkScrollbars","preventDefault","probeType"]),o=r.filter(e,["top","left","right","bottom","width"]),s=e.pulldown||{},u=e.pullup||{},l={id:n,enabled:!0,options:a,style:o,puller:{binded:!1},pulldown:{min:s.min,max:s.max,top:s.top,release:s.release,translateY:s.translateY,tips:s.tips,load:s.load,enabled:!1,binded:!1},pullup:{min:u.min,max:u.max,bottom:u.bottom,release:u.release,translateY:u.translateY,lastPage:u.lastPage,tips:u.tips,load:u.load,enabled:!1,binded:!1},container:null,scroller:null,emitter:null,this:null,$:null};return x.assign(l,t),l}}}),q("Scroller/IScroll",function(e,t,n){var r=e("$"),i=(e("Object"),e("IScroll"));function a(e){var t=e.indicators||[],n=e.hasHorizontalScroll,r=e.hasVerticalScroll,i=t.length;return 1==i&&(n||r)||2==i&&n&&r}return{create:function(e,t){e instanceof r&&(e=e.get(0));var n=new i(e,t),o=function(e){var t=e.indicators||[];return t=t.map(function(e,t){return r(e.indicator)})}(n),s=!1,u=null;return o.forEach(function(e){e.hide()}),n.on("scroll",function(){this.hasVerticalScroll||this._translate(0,.5*this.distY>>0)}),n.on("scrollStart",function(){s=!0,clearTimeout(u),a(n)&&o.forEach(function(e,t){e.css("opacity",1),e.show()})}),n.on("scrollEnd",function(){s=!1,u=f(function(){a(n)&&o.forEach(function(e,t){e.fadeOut("fast",function(){s&&(e.css("opacity",1),e.show())})})},100)}),n}}}),q("IScroll",function(e,t,n){return r.IScroll||null}),q("Scroller/Puller",function(e,t,n){return{bind:function(e){var t=e.puller,n=e.scroller,r=e.pulldown,i=e.pullup,a=r.enabled||i.enabled;if(n&&a&&!t.binded){t.binded=!0;var o=0,s=!1,u="",l=0,c=0;n.on("scrollStart",function(){var e=this.directionY,t=this.distY;u=(s=0==e?t<0:e>0)?"pullup":"pulldown",o=0,n.isWaitingForManualReset=!1,s?(l=i.min-this.maxScrollY,c=i.max-this.maxScrollY):(l=r.min,c=r.max)}),n.on("scroll",function(){var t=this.y;s&&(t=-t),e.emitter.fire(u,"scroll",[t,this]),t<l?0==(1&o)&&(o=1,e.emitter.fire(u,"start")):l<=t&&t<c?0==(2&o)&&(o=2,e.emitter.fire(u,"enter")):t>=c&&0==(4&o)&&(o=4,e.emitter.fire(u,"reach"))}),n.on("beforeScrollEnd",function(){4==(4&o)?(n.isWaitingForManualReset=s?i.enabled:r.enabled,e.emitter.fire(u,"release")):e.emitter.fire(u,"cancel")})}}}}),q("Scroller/Pulldown",function(e,t,n){var r=t.require("Indicator"),i=t.require("Loading");return{bind:function(e){var t=e.pulldown;if(t.load&&t.enabled&&!t.binded){var n=t.tips,a=!1,o=r.create({container:e.container,translateY:t.translateY}),s=i.create({container:e.container,top:t.top,text:n.loading});t.binded=!0,e.this.on("pullup",{start:function(){s.hide(),o.hide()}}),e.this.on("pulldown",{scroll:function(e,n){var r=e+t.translateY;r=b.min(r,10),o.$.css({transform:`translateY(${r}px)`})},start:function(){a||(s.hide(),o.show(),o.$.html(n.start))},enter:function(){a&&s.show()},reach:function(){a||o.$.html(n.reach)},cancel:function(){s.hide(),o.$.css({transform:`translateY(${t.translateY}px)`})},release:function(){e.this.to(t.release),a||(a=!0,s.show(),o.hide(),t.load(function(){a=!1,s.hide(),o.$.html(n.success),o.show(),f(function(){o.hide(),o.$.html(n.start),e.this.reset()},500)}))}})}}}}),q("Scroller/Pulldown/Indicator",function(e,t,n){var r=e("$"),i=e("String"),a=e("Panel"),o=t.require("Sample");return{create:function(e){var t=i.random(),n=i.format(o,{id:t,translateY:e.translateY});return r(e.container).append(n),new a(`#${t}`)}}}),q("Scroller/Pulldown/Indicator/Sample",["","",'<div id="{id}" class="Scroller-Pulldown-Indicator" style="display: none; transform: translateY({translateY}px);">下拉刷新</div>'].join("\n")),q("Scroller/Pulldown/Loading",function(e,t,n){e("$"),e("String");var r=e("Loading");return{create:function(e){return new r({container:e.container,text:e.text,presetting:"scroller.pulldown","z-index":9999,style:{top:e.top}})}}}),q("Scroller/Pullup",function(e,t,n){var r=t.require("Indicator"),i=t.require("Loading");return{bind:function(e){var t=e.pullup;if(t.load&&t.enabled&&!t.binded){var n=!1,a=t.tips,o=r.create({container:e.container,translateY:t.translateY}),s=i.create({container:e.container,text:a.loading,bottom:t.bottom});t.binded=!0,e.this.on("pulldown",{start:function(){s.hide(),o.hide()}}),e.this.on("pullup",{scroll:function(e,n){var r=-(e+n.maxScrollY)+t.translateY;r=b.max(r,-t.bottom),o.$.css({transform:`translateY(${r}px)`})},start:function(){n||(s.hide(),o.show(),t.lastPage?o.$.html(a.lastPage):o.$.html(a.start))},enter:function(){n&&s.show()},reach:function(){t.lastPage||n||o.$.html(a.reach)},cancel:function(){s.hide(),o.$.css({transform:`translateY(${t.translateY}px)`})},release:function(){if(t.lastPage)return s.hide(),o.hide(),void e.this.reset();e.this.toBottom(t.release),n||(s.show(),o.hide(),n=!0,t.load(function(){n=!1,s.hide(),e.this.reset()}))}})}}}}),q("Scroller/Pullup/Indicator",function(e,t,n){var r=e("$"),i=e("String"),a=e("Panel"),o=t.require("Sample");return{create:function(e){var t=i.random(),n=i.format(o,{id:t,translateY:e.translateY});return r(e.container).append(n),new a(`#${t}`)}}}),q("Scroller/Pullup/Indicator/Sample",["","",'<div id="{id}" class="Scroller-Pullup-Indicator" style="display: none; transform: translateY({translateY}px); ">上拉加载更多</div>'].join("\n")),q("Scroller/Pullup/Loading",function(e,t,n){e("$"),e("String");var r=e("Loading");return{create:function(e){return new r({container:e.container,text:e.text,presetting:"scroller.pullup","z-index":9999,style:{bottom:e.bottom}})}}}),q("Dialog/Style",function(e,t,n){var r=e("Object"),i=e("Style");return{get:function(e){var t=r.filter(e,["height","width","z-index"]),n=i.objectify(e.style);return n=i.merge(n,t),n=i.pixelize(n,["height","width"])}}}),q("Dialog/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId"),i="KISP-Dialog-";return{create:function(e,t){var n=r.get(i,4),a=e.buttons||[];a=a.map(function(e){return"string"==e?{text:e}:e});var o={id:n,headerId:r.get(i,"header-",4),articleId:r.get(i,"article-",4),contentId:r.get(i,"content-",4),footerId:r.get(i,"footer-",4),scrollable:e.scrollable,scrollerConfig:e.scroller,eventName:e.eventName,title:e.title,content:e.content,buttons:a,"z-index":e["z-index"],width:e.width,height:e.height,autoClose:e.autoClose,volatile:e.volatile,cssClass:e.cssClass||"",container:e.container,pressedClass:"Pressed",visible:!1,style:{},data:{},scroller:null,masker:null,emitter:null,this:null,$:null,$header:null,$content:null,$footer:null};return x.assign(o,t),o}}}),q("Dialog/Masker",function(e,t,n){e("$");return{create:function(t){var n=e("Mask"),r={container:t.container},i=n.normalize(r,t.mask);return i?(x.assign(i,{volatile:t.volatile,"z-index":t["z-index"]-1}),new n(i)):null}}}),q("Dialog/Events",function(e,t,n){e("Template"),e("Array"),e("String");return{bind:function(e){e.masker&&e.volatile&&e.masker.on({show:function(){},hide:function(){e.this.hide()}}),function(){if(e.buttons.length){var t=e.$footer,n=e.eventName,r="button[data-index]",i=e.pressedClass;"touch"!=n?(t.on(n,r,a),t.on("mousedown",r,function(e){C(this).addClass(i)}),t.on("mouseup mouseout",r,function(e){C(this).removeClass(i)})):t.touch(r,a,i)}function a(t){var n=+this.getAttribute("data-index"),r=e.buttons[n],i=r.cmd||k(n),a=r.fn;a&&a(r,n),e.emitter.fire("button",i,[r,n]),e.emitter.fire("button",[r,n]);var o=r.autoClose;o===T&&(o=e.autoClose),o&&e.this.hide()}}()}}}),q("Dialog/Template",function(e,t,n){var r=e("Template"),i=(e("Array"),e("String"),e("Style")),a=t.require("Sample"),o=r.create(a);return o.process({"":function(e){var t=this.fill("header",e),n=this.fill("content",e),r=this.fill("footer",e),a=i.stringify(e.style);return{id:e.id,cssClass:e.cssClass||"",style:a,header:t,content:n,footer:r}},header:function(e){var t=e.title;return t?{headerId:e.headerId,title:t}:""},content:function(e){return{articleId:e.articleId,contentId:e.contentId,content:e.content,noHeader:e.title?"":"NoHeader",noFooter:e.buttons.length>0?"":"NoFooter"}},footer:{"":function(e){var t=e.buttons,n=t.length;return n?(t=this.fill("button",t),{footerId:e.footerId,count:n,buttons:t}):""},button:function(e,t){var n=i.stringify(e.style);return{index:t,text:e.text,cssClass:e.cssClass||"",style:n}}}}),o}),q("Dialog/Template/Sample",["",'<div id="{id}" class="KISP Dialog {cssClass}" style="{style} display: none;">','    <template name="header" placeholder="header">','        <header id="{headerId}">',"            {title}","        </header>","    </template>","",'    <template name="content" placeholder="content">','        <article id="{articleId}" class="{noHeader} {noFooter}">','            <div id="{contentId}">{content}</div>',"        </article>","    </template>","",'    <template name="footer" placeholder="footer">','        <footer id="{footerId}" class="Buttons-{count}">','            <template name="button" placeholder="buttons">','                <button data-index="{index}" class="{cssClass}" style="{style}">{text}</button>',"            </template>","        </footer>","    </template>","</div>",""].join("\n")),q("Alert/Dialog/Height",function(e,t,n){var r=e("String");return{get:function(e){var t=function(e){e=k(e);var t=r.getByteLength(e),n=b.max(t,125);return n>=.8*i.documentElement.clientHeight&&(n="80%"),n}(e),n=function(e){var t=25*(e=k(e)).split("\n").length+60;return t>=.8*i.documentElement.clientHeight&&(t="80%"),t}(e),a=b.max(t,n);return"number"==typeof a&&(a=a%2==1?a+1:a),a}}}),q("Alert/Sample",['<pre class="JSON">{text}</pre>'].join("\n")),q("Confirm",function(e,t,n){e("String");var r=e("Defaults"),a=null,o=!1,s=[],u=null,l=13;function c(n){(a=a||function(){var n=e("Dialog"),a=r.clone(t.id),f=new n({cssClass:t.id,volatile:a.volatile,mask:a.mask,autoClose:a.autoClose,height:a.height,"z-index":a["z-index"],buttons:a.buttons,scrollable:a.scrollable});return f.on("button",{ok:function(){var e=f.data("ok");e&&e()},cancel:function(){var e=f.data("cancel");e&&e()}}),f.on({show:function(){o=!0,l=13==l?"enter":"",(u=i.activeElement).blur(),f.$.find("footer button").get(0).focus()},hide:function(){o=!1;var e=s.shift();e&&c(e),u&&u.focus(),u=null,l=""}}),C(i).on({keydown:function(e){l=e.keyCode},keyup:function(e){if(13==e.keyCode&&o&&"enter"!=l){f.hide();var t=f.data("ok");t&&t()}}}),f}()).data(n),a.set({content:n.text}),a.show()}return{show:function(e,t,n){var r="object"==typeof e?e:{text:e,ok:t,cancel:n};o?s.push(r):c(r)}}}),q("Confirm.defaults",{mask:!0,height:140,autoClose:!0,volatile:!1,"z-index":99999,buttons:[{text:"确定",cmd:"ok",cssClass:"OK"},{text:"取消",cmd:"cancel",cssClass:"Cancel"}]}),q("Confirm.config",{scrollable:!0}),q("API",function(e,t,n){var r=e("Emitter"),i=e("Defaults"),a=e("Fn"),o=e("Mapper");function s(e,n){"object"==typeof e&&(n=e,e=""),e=e||"",n=i.clone(t.id,n);var s=new r(this),u=n.successCode,l=n.proxy;switch(l){case!0:l=e+".js";break;case".json":case".js":l=e+l}var c={name:e,data:n.data,query:n.query,url:n.url,prefix:n.prefix,ext:n.ext,random:n.random,successCode:u,field:n.field,proxy:l,serialize:n.serialize,timeout:n.timeout,headers:n.headers,success:function(e,t,n){h("success",[e,t,n])},fail:function(e,t,n,r){h("fail",[e,t,n,r])},error:function(e){d.aborted?d.aborted=!1:h("error",[e])},ontimeout:function(e){h("timeout",[e])}},f=t.require("Ajax"),d={ajax:c,status:"",args:[],emitter:s,xhr:null,aborted:!1,fireEvent:h,get:n.get||f.get,post:n.post||f.post};function h(e,t,r){e=d.status=e||d.status,t=d.args=t||d.args,r=r||d.emitter,d.xhr=null;var i=t.length,o=t[i-1],s=t[i-2],l="success"==e,c="fail"==e;a.delay(n.delay,function(){var n=r.fire("response",[e,s,o]);if(!n.includes(!1)){if(l||c){var i=l?u:t[0];if((n=r.fire("code",i,t)).includes(!1))return}o&&(n=r.fire("status",o.status,t)).includes(!1)||(n=r.fire(e,t)).includes(!1)||r.fire("done",[e,s,o])}})}o.set(this,d)}return s.prototype={constructor:s,get:function(e){var t=o.get(this),n=t.emitter;t.aborted=!1;var r=x.assign({},t.ajax);e&&(r.data=e),e=r.data,n.fire("request","get",[e]),n.fire("request",["get",e]),t.xhr=t.get(r)},post:function(e,t){var n=o.get(this),r=n.emitter,i=n.ajax;n.aborted=!1;var a=x.assign({},i,{data:e||i.data,query:t||i.query});e=a.data,t=a.query,r.fire("request","post",[e,t]),r.fire("request",["post",e,t]),n.xhr=n.post(a)},abort:function(){var e=o.get(this),t=e.xhr;t&&(e.aborted=!0,t.abort(),e.emitter.fire("abort"))},on:function(e,t){var n=o.get(this),i=n.emitter,a=[].slice.call(arguments,0);i.on.apply(i,a);var s=n.status;if(s){var u=new r(this);u.on.apply(u,a),n.fireEvent(s,n.args,u),u.destroy()}},destroy:function(){o.get(this).emitter.destroy(),o.delete(this)}},s}),q("API.defaults",{successCode:200,field:{code:"code",msg:"msg",data:"data"},proxy:null,delay:!1,random:!0,url:"",prefix:"",ext:"",data:null,query:null,headers:null,timeout:0,serialize:function(e,t){var n=y.stringify(t);return encodeURIComponent(n)},get:null,post:null}),q("API/Ajax",function(e,t,n){var r=e("Object"),i=e("String"),a=e("Query");function o(t,n){var o=n.proxy;if(o)return e("Proxy").request(o,n),null;var s=[n.url,n.prefix,n.name,n.ext].join(""),u=n.data||null;if(u){var l=n.serialize;u=r.map(u,function(e,t){return"object"==typeof t&&t?l(e,t):t})}if("post"==t){var c=n.query;c&&(s=a.add(s,c)),u&&(u=a.stringify(u))}else u&&(s=a.add(s,u),u=null);var d=n.random;d&&(d=i.random(4),s=a.add(s,d));var h=!1,p=null,g=n.timeout||0;g>0&&(p=f(function(){h=!0,v.abort();var e=n.ontimeout;e&&e(v)},g));var v=new XMLHttpRequest;v.open(t,s,!0),v.onreadystatechange=function(){if(!h&&4==v.readyState){clearTimeout(p);var t=n.successCode,r=n.error;if(200==v.status){var i=e("JSON").parse(v.responseText);if(i){var a=n.field,o=i[a.code];if(o==t){var s=n.success,u=a.data in i?i[a.data]:{};s&&s(u,i,v)}else{var l=n.fail;l&&l(o,i[a.msg],i,v)}}else r&&r(v)}else r&&r(v)}};var m=n.headers;return m&&r.each(m,function(e,t){v.setRequestHeader(e,t)}),"post"==t&&v.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),v.send(u),v}return{get:function(e){return o("get",e)},post:function(e){return o("post",e)}}}),q("Tabs",function(e,t,n){var r=e("Emitter"),i=e("Object"),a=e("Template"),o=e("Defaults"),s=t.require("Events"),u=t.require("Meta"),l=new w;function c(e,n){i.isPlain(e)&&(e=(n=e).container),n=o.clone(t.id,n);var a=new r(this),s=u.create(n,{container:e,this:this,emitter:a,$:C(e)});l.set(this,s),x.assign(this,{container:e,id:s.id,$:s.$})}return c.prototype={constructor:c,container:"",id:"",$:null,template:function(e){var t=l.get(this),n=t.tpl;return n||(n=t.tpl=new a(t.container)),e&&n.process(...arguments),n},fill:function(e,t){var n=l.get(this),r=this.template(t).fill(e);return n.$.html(r),n.list=e,n.reset(),n.emitter.fire("fill",[e]),r},render:function(e,t){var n=l.get(this);n.change||s.bind(n),e&&this.fill(e,t),n.emitter.fire("render",[e])},active:function(e,t){var n=!0;"boolean"==typeof t?(n=t,t={}):t=t||{};var r=l.get(this),i=r.current;if(e!=i.index||r.repeated){var a=r.list[e]||null,o=r.activedClass,s=x.assign({},i);i.$&&i.$.removeClass(o),i.index=e,i.item=a,i.event=t.event,i.$=r.$.find(`${r.selector}:eq(${e})`);var u={current:i,old:s,options:t};r.activing(u,function(){if(i.$.addClass(o),n){var t=[a,e,u],s=a&&a.cmd||"";r.emitter.fire("before-change",t),r.emitter.fire("change",`${e}`,t),s&&r.emitter.fire("change",s,t),r.emitter.fire("change",t)}})}},remove:function(e){var t=l.get(this),n=t.current.index;t.fire("before-remove",[e]),e<n?this.active(n-1,!1):e==n&&t.reset(),t.list.splice(e,1),t.fire("remove",[e])},reset:function(){l.get(this).reset()},getActivedIndex:function(){return l.get(this).current.index},activing:function(e){var t=l.get(this);if("function"!=typeof(e=e||t.activing))throw new v("参数 fn 必须为 function 类型。");return t.activing=e,e},on:function(...e){l.get(this).emitter.on(...e)},destroy:function(){var e=l.get(this);e.emitter.destroy(),e.tpl.destroy(),e.$.off(),l.delete(this)}},c}),q("Tabs.defaults",{current:null,pressedClass:"",activedClass:"",eventName:"click",selector:">*",repeated:!1}),q("Tabs.config",{eventName:"touch"}),q("Tabs/Events",function(e,t,n){e("Array"),e("String");return{bind:function(t){var n=t.eventName,r=t.selector,i=t.pressedClass;if(t.change=function(e){var n=this,i=t.$.find(r).toArray().findIndex(function(e){return e===n});t.this.active(i,{event:e})},"touch"==n)return e("Touch"),void t.$.touch(r,t.change,i);t.$.on(n,r,t.change),t.$.on("mousedown",r,function(e){C(this).addClass(i)}),t.$.on("mouseup mouseout",r,function(e){C(this).removeClass(i)})}}}),q("Tabs/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId");return{create:function(e,t){var n={id:r.get("KISP-Tabs-",4),activedClass:e.activedClass||"",pressedClass:e.pressedClass||"",eventName:e.eventName||"",selector:e.selector||"",repeated:!!e.repeated,list:e.list||[],current:{index:-1,item:null,event:null,$:null},container:null,tpl:null,emitter:null,this:null,$:null,change:null,reset:function(){n.$.find(n.selector).removeClass(n.activedClass),n.current={index:-1,item:null,event:null,$:null}},activing:function(e,t){t()}};return x.assign(n,t),n}}}),q("Toast",function(e,t,n){var r=e("String"),i=e("Emitter"),a=e("Defaults"),o=t.require("Sample"),s=t.require("Style"),u=t.require("Meta"),l=t.require("Masker"),c=new w;function d(e){e=a.clone(t.id,e);var n=new i(this),r=s.get(e),f=l.create(e),d=u.create(e,{sample:o,style:r,emitter:n,masker:f,this:this});c.set(this,d),x.assign(this,{id:d.id})}return d.prototype={constructor:d,id:"",$:null,render:function(){var t=c.get(this);if(!t.$){var n=e("Style").stringify(t.style),i=r.format(t.sample,{id:t.id,icon:t.icon,text:t.text,textId:t.textId,iconId:t.iconId,cssClass:t.cssClass,style:n});C(t.container).append(i),t.$=this.$=C(`#${t.id}`),t.$icon=C(`#${t.iconId}`),t.$text=C(`#${t.textId}`),t.emitter.fire("render")}},show:function(e,t){"function"==typeof e&&(t=e,e=T);var n=c.get(this),r=n.masker,i=n.duration;n.$||this.render(),r&&r.show(),"string"==typeof e&&(n.text=e,n.$text.html(e)),i&&f(function(){n.this.hide(),t&&t()},i),n.$.toggleClass("NoIcon",!n.icon),n.$.toggleClass("NoText",!n.text),n.$.show(),n.emitter.fire("show")},hide:function(){var e=c.get(this),t=e.masker;e.$&&(t&&t.hide(),e.$.hide(),e.emitter.fire("hide"))},remove:function(){var e=c.get(this);if(e.$){var t=e.$.get(0),n=e.masker;t.parentNode.removeChild(t),n&&n.remove(),e.$.off(),e.$=this.$=null,e.$icon=null,e.$text=null,e.masker=null,e.emitter.fire("remove")}},on:function(...e){c.get(this).emitter.on(...e)},destroy:function(){var e=c.get(this);this.remove(),e.emitter.destroy(),c.remove(this)}},d}),q("Toast.defaults",{text:"",container:"body",mask:!1,icon:"check",duration:0,cssClass:"","z-index":1024,width:"",height:"",style:{}}),q("Toast/Sample",['<div id="{id}" class="KISP Toast {cssClass}" style="{style}">',"    <div>",'        <i id="{iconId}" class="fa fa-{icon}"></i>',"    </div>",'    <span id="{textId}" class="Text">{text}</span>',"</div>"].join("\n")),q("Toast/Style",function(e,t,n){var r=e("Object"),i=e("Style");return{get:function(e){var t=r.filter(e,["height","width","z-index"]),n=i.objectify(e.style);return n=i.merge(n,t),n=i.pixelize(n,["height","width"])}}}),q("Toast/Meta",function(e,t,n){e("$"),e("String");var r=e("RandomId");return{create:function(e,t){var n=r.get("KISP-Toast-",4),i=r.get("KISP-Toast-","text-",4),a=r.get("KISP-Toast-","icon-",4),o=e.text;o=(o="number"==typeof o?k(o):o)||"";var s={id:n,icon:e.icon,text:o,textId:i,iconId:a,cssClass:e.cssClass||"",container:e.container,duration:e.duration||0,sample:"",style:"",masker:null,emitter:null,this:null,$:null,$icon:null,$text:null};return x.assign(s,t),s}}}),q("Toast/Masker",function(e,t,n){e("$");return{create:function(t){var n=e("Mask"),r={container:t.container},i=n.normalize(r,t.mask);return i?(x.assign(i,{"z-index":t["z-index"]-1}),new n(i)):null}}}),q("MD5",function(e,t,n){function r(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,a,o){return r((s=r(r(t,e),r(i,o)))<<(u=a)|s>>>32-u,n);var s,u}function a(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)}function o(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)}function s(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)}function u(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)}function l(e,t){var n,i,l,c,f;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var d=1732584193,h=-271733879,p=-1732584194,g=271733878;for(n=0;n<e.length;n+=16)i=d,l=h,c=p,f=g,h=u(h=u(h=u(h=u(h=s(h=s(h=s(h=s(h=o(h=o(h=o(h=o(h=a(h=a(h=a(h=a(h,p=a(p,g=a(g,d=a(d,h,p,g,e[n],7,-680876936),h,p,e[n+1],12,-389564586),d,h,e[n+2],17,606105819),g,d,e[n+3],22,-1044525330),p=a(p,g=a(g,d=a(d,h,p,g,e[n+4],7,-176418897),h,p,e[n+5],12,1200080426),d,h,e[n+6],17,-1473231341),g,d,e[n+7],22,-45705983),p=a(p,g=a(g,d=a(d,h,p,g,e[n+8],7,1770035416),h,p,e[n+9],12,-1958414417),d,h,e[n+10],17,-42063),g,d,e[n+11],22,-1990404162),p=a(p,g=a(g,d=a(d,h,p,g,e[n+12],7,1804603682),h,p,e[n+13],12,-40341101),d,h,e[n+14],17,-1502002290),g,d,e[n+15],22,1236535329),p=o(p,g=o(g,d=o(d,h,p,g,e[n+1],5,-165796510),h,p,e[n+6],9,-1069501632),d,h,e[n+11],14,643717713),g,d,e[n],20,-373897302),p=o(p,g=o(g,d=o(d,h,p,g,e[n+5],5,-701558691),h,p,e[n+10],9,38016083),d,h,e[n+15],14,-660478335),g,d,e[n+4],20,-405537848),p=o(p,g=o(g,d=o(d,h,p,g,e[n+9],5,568446438),h,p,e[n+14],9,-1019803690),d,h,e[n+3],14,-187363961),g,d,e[n+8],20,1163531501),p=o(p,g=o(g,d=o(d,h,p,g,e[n+13],5,-1444681467),h,p,e[n+2],9,-51403784),d,h,e[n+7],14,1735328473),g,d,e[n+12],20,-1926607734),p=s(p,g=s(g,d=s(d,h,p,g,e[n+5],4,-378558),h,p,e[n+8],11,-2022574463),d,h,e[n+11],16,1839030562),g,d,e[n+14],23,-35309556),p=s(p,g=s(g,d=s(d,h,p,g,e[n+1],4,-1530992060),h,p,e[n+4],11,1272893353),d,h,e[n+7],16,-155497632),g,d,e[n+10],23,-1094730640),p=s(p,g=s(g,d=s(d,h,p,g,e[n+13],4,681279174),h,p,e[n],11,-358537222),d,h,e[n+3],16,-722521979),g,d,e[n+6],23,76029189),p=s(p,g=s(g,d=s(d,h,p,g,e[n+9],4,-640364487),h,p,e[n+12],11,-421815835),d,h,e[n+15],16,530742520),g,d,e[n+2],23,-995338651),p=u(p,g=u(g,d=u(d,h,p,g,e[n],6,-198630844),h,p,e[n+7],10,1126891415),d,h,e[n+14],15,-1416354905),g,d,e[n+5],21,-57434055),p=u(p,g=u(g,d=u(d,h,p,g,e[n+12],6,1700485571),h,p,e[n+3],10,-1894986606),d,h,e[n+10],15,-1051523),g,d,e[n+1],21,-2054922799),p=u(p,g=u(g,d=u(d,h,p,g,e[n+8],6,1873313359),h,p,e[n+15],10,-30611744),d,h,e[n+6],15,-1560198380),g,d,e[n+13],21,1309151649),p=u(p,g=u(g,d=u(d,h,p,g,e[n+4],6,-145523070),h,p,e[n+11],10,-1120210379),d,h,e[n+2],15,718787259),g,d,e[n+9],21,-343485551),d=r(d,i),h=r(h,l),p=r(p,c),g=r(g,f);return[d,h,p,g]}function c(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=k.fromCharCode(e[t>>5]>>>t%32&255);return n}function f(e){var t,n=[];for(n[(e.length>>2)-1]=T,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return r}function p(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return c(l(f(e),8*e.length))}(p(e))}function v(e,t){return function(e,t){var n,r,i=f(e),a=[],o=[];for(a[15]=o[15]=T,i.length>16&&(i=l(i,8*e.length)),n=0;n<16;n+=1)a[n]=909522486^i[n],o[n]=1549556828^i[n];return r=l(a.concat(f(t)),512+8*t.length),c(l(o.concat(r),640))}(p(e),p(t))}function m(e,t,n){return t?n?v(t,e):d(v(t,e)):n?g(e):d(g(e))}return{encrypt:function(e){return arguments.length>1&&(e=h.from(arguments).join("")),m(e)}}}),q("Loading/Sample/IOS",['<div id="{id}" class="KISP Loading-iOS {cssClass}" >','    <div class="Main">','        <div class="Item-0"></div>','        <div class="Item-1"></div>','        <div class="Item-2"></div>','        <div class="Item-3"></div>','        <div class="Item-4"></div>','        <div class="Item-5"></div>','        <div class="Item-6"></div>','        <div class="Item-7"></div>','        <div class="Item-8"></div>','        <div class="Item-9"></div>','        <div class="Item-10"></div>','        <div class="Item-11"></div>',"    </div>",'    <span id="{textId}" class="Text">{text}</span>',"</div>"].join("\n")),I=E.require,j=I("KISP"),P=I("OuterModule"),e.KISP=j,e.define=P.define}(window,top,parent,window,document,location,navigator,localStorage,sessionStorage,console,history,setTimeout,setInterval,Array,Boolean,Date,Error,Function,JSON,Map,Math,Number,Object,RegExp,String,window.jQuery,void 0);